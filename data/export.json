{
    "_criteria": "objectId in ('11ed0bf196504518928e4974dba704c4','11ed4a12fe9779f5b3ee959a23fb02d0')",
    "_rootApiName": [
        "sparkJobInfo"
    ],
    "sparkJobInfo": [
        {
            "jobName": "费控(二期)_可控费用率排名",
            "updateDate": "2022-10-13 16:05:00",
            "pOrgId": null,
            "updateLogin": "jiangshan",
            "schedulerConf": null,
            "description": null,
            "dagId": "11ed4a12fe97ef26b3ee1df8b8dd6145",
            "pAppId": null,
            "versionNumber": 1,
            "dataFlowId": null,
            "pDeleted": "FALSE",
            "createBy": "11ec0008a7d6e713ac562bef87a44fb9",
            "directoryPath": "00001,00013",
            "updateBy": "11ec0008a7d6e713ac562bef87a44fb9",
            "azkabanProjectId": null,
            "tenantId": "system",
            "attribute": "{\"failureAction\":\"finishCurrent\",\"concurrentOption\":\"skip\"}",
            "autoCreated": 0,
            "objectId": "11ed4a12fe9779f5b3ee959a23fb02d0",
            "azkabanExecId": "405",
            "onlineState": 0,
            "status": null,
            "createDate": "2022-10-12 17:48:15"
        },
        {
            "jobName": "费控(dwd-dws)_部门项目支出类型信息明细表_zly",
            "updateDate": "2022-10-24 10:54:09",
            "pOrgId": null,
            "updateLogin": "system",
            "schedulerConf": null,
            "description": null,
            "dagId": "11ed0bf19650e159928e7b7d5ec54760",
            "pAppId": null,
            "versionNumber": 12,
            "dataFlowId": null,
            "pDeleted": "FALSE",
            "createBy": "11ec0008a7d6e713ac562bef87a44fb9",
            "directoryPath": "00001,00013",
            "updateBy": "11ec0008a7d6e713ac562bef87a44fb9",
            "azkabanProjectId": null,
            "tenantId": "system",
            "attribute": "{\"failureAction\":\"finishCurrent\",\"concurrentOption\":\"skip\"}",
            "autoCreated": 0,
            "objectId": "11ed0bf196504518928e4974dba704c4",
            "azkabanExecId": "195",
            "onlineState": 0,
            "status": null,
            "createDate": "2022-07-25 16:12:55"
        }
    ],
    "dagInfo": [
        {
            "updateDate": "2022-10-13 16:05:00",
            "pOrgId": "",
            "updateLogin": "jiangshan",
            "pAppId": "",
            "externalParameter": "",
            "versionNumber": 78,
            "pDeleted": "FALSE",
            "graphJson": "{\"cells\":[{\"shape\":\"edge\",\"attrs\":{\"line\":{\"stroke\":\"#999999\",\"targetMarker\":{\"name\":\"block\",\"size\":8}}},\"id\":\"e352ccae-f5a0-4e98-b5fe-37694e52f7a9\",\"defaultLabel\":{\"markup\":{\"tagName\":\"foreignObject\",\"selector\":\"fo\",\"children\":[{\"ns\":\"http://www.w3.org/1999/xhtml\",\"tagName\":\"body\",\"selector\":\"foBody\",\"attrs\":{\"xmlns\":\"http://www.w3.org/1999/xhtml\"},\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"background\":\"transparent\"},\"children\":[{\"tagName\":\"div\",\"selector\":\"foContent\",\"style\":{\"width\":\"100%\",\"height\":\"100%\"}}]}]},\"attrs\":{\"fo\":{\"width\":120,\"height\":30,\"x\":60,\"y\":-15}}},\"router\":{\"name\":\"manhattan\",\"args\":{\"startDirections\":[\"right\"],\"endDirections\":[\"left\"]}},\"connector\":{\"name\":\"rounded\",\"args\":{\"radius\":5}},\"zIndex\":0,\"source\":{\"cell\":\"e5ce16d6-8dcd-4021-83c0-476b5f69f8cc\",\"port\":\"dd8c28d4-6976-4db3-a050-a77b38110971\"},\"target\":{\"cell\":\"58f178ec-4011-4d30-a8a3-22f1913119df\",\"port\":\"e68e3657-83ce-4348-8b62-3ad3a10726b7\"}},{\"shape\":\"edge\",\"attrs\":{\"line\":{\"stroke\":\"#999999\",\"targetMarker\":{\"name\":\"block\",\"size\":8}}},\"id\":\"2ec17073-f3b2-45ee-90d2-f15fdbd5f5ac\",\"defaultLabel\":{\"markup\":{\"tagName\":\"foreignObject\",\"selector\":\"fo\",\"children\":[{\"ns\":\"http://www.w3.org/1999/xhtml\",\"tagName\":\"body\",\"selector\":\"foBody\",\"attrs\":{\"xmlns\":\"http://www.w3.org/1999/xhtml\"},\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"background\":\"transparent\"},\"children\":[{\"tagName\":\"div\",\"selector\":\"foContent\",\"style\":{\"width\":\"100%\",\"height\":\"100%\"}}]}]},\"attrs\":{\"fo\":{\"width\":120,\"height\":30,\"x\":60,\"y\":-15}}},\"router\":{\"name\":\"manhattan\",\"args\":{\"startDirections\":[\"right\"],\"endDirections\":[\"left\"]}},\"connector\":{\"name\":\"rounded\",\"args\":{\"radius\":5}},\"zIndex\":0,\"source\":{\"cell\":\"48797311-2f85-45a2-ab90-875759c3d1a4\",\"port\":\"d14abfad-f87f-479d-8c5b-8d268ec8722b\"},\"target\":{\"cell\":\"9eea5d17-151a-4f98-8404-b901024f6c90\",\"port\":\"54f4ad44-affc-430f-8591-d04bc387bc7d\"}},{\"shape\":\"edge\",\"attrs\":{\"line\":{\"stroke\":\"#999999\",\"targetMarker\":{\"name\":\"block\",\"size\":8}}},\"id\":\"9264f295-2d8e-4ea1-ac30-6dbb601fa058\",\"defaultLabel\":{\"markup\":{\"tagName\":\"foreignObject\",\"selector\":\"fo\",\"children\":[{\"ns\":\"http://www.w3.org/1999/xhtml\",\"tagName\":\"body\",\"selector\":\"foBody\",\"attrs\":{\"xmlns\":\"http://www.w3.org/1999/xhtml\"},\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"background\":\"transparent\"},\"children\":[{\"tagName\":\"div\",\"selector\":\"foContent\",\"style\":{\"width\":\"100%\",\"height\":\"100%\"}}]}]},\"attrs\":{\"fo\":{\"width\":120,\"height\":30,\"x\":60,\"y\":-15}}},\"router\":{\"name\":\"manhattan\",\"args\":{\"startDirections\":[\"right\"],\"endDirections\":[\"left\"]}},\"connector\":{\"name\":\"rounded\",\"args\":{\"radius\":5}},\"zIndex\":0,\"source\":{\"cell\":\"58f178ec-4011-4d30-a8a3-22f1913119df\",\"port\":\"4cf4474c-1286-4a91-9c1f-44bec7dc5420\"},\"target\":{\"cell\":\"63a631d9-3f71-41d8-bc28-fd77668e9277\",\"port\":\"12c0b840-9b15-43bb-a0b3-4754f421bf0a\"}},{\"shape\":\"edge\",\"attrs\":{\"line\":{\"stroke\":\"#999999\",\"targetMarker\":{\"name\":\"block\",\"size\":8}}},\"id\":\"05a3196f-4ded-4c28-bcd2-80231e4f6260\",\"defaultLabel\":{\"markup\":{\"tagName\":\"foreignObject\",\"selector\":\"fo\",\"children\":[{\"ns\":\"http://www.w3.org/1999/xhtml\",\"tagName\":\"body\",\"selector\":\"foBody\",\"attrs\":{\"xmlns\":\"http://www.w3.org/1999/xhtml\"},\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"background\":\"transparent\"},\"children\":[{\"tagName\":\"div\",\"selector\":\"foContent\",\"style\":{\"width\":\"100%\",\"height\":\"100%\"}}]}]},\"attrs\":{\"fo\":{\"width\":120,\"height\":30,\"x\":60,\"y\":-15}}},\"router\":{\"name\":\"manhattan\",\"args\":{\"startDirections\":[\"right\"],\"endDirections\":[\"left\"]}},\"connector\":{\"name\":\"rounded\",\"args\":{\"radius\":5}},\"zIndex\":0,\"source\":{\"cell\":\"63a631d9-3f71-41d8-bc28-fd77668e9277\",\"port\":\"9d3149f6-1bd6-4107-8105-7302e763fb37\"},\"target\":{\"cell\":\"72f49566-f6f7-425e-b5ec-bc89ace846f6\",\"port\":\"ac84fa78-32f5-49d7-8a16-c851b3ddb7da\"}},{\"shape\":\"edge\",\"attrs\":{\"line\":{\"stroke\":\"#999999\",\"targetMarker\":{\"name\":\"block\",\"size\":8}}},\"id\":\"de2a9047-5c79-47f8-8c24-4a98f0db6e00\",\"defaultLabel\":{\"markup\":{\"tagName\":\"foreignObject\",\"selector\":\"fo\",\"children\":[{\"ns\":\"http://www.w3.org/1999/xhtml\",\"tagName\":\"body\",\"selector\":\"foBody\",\"attrs\":{\"xmlns\":\"http://www.w3.org/1999/xhtml\"},\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"background\":\"transparent\"},\"children\":[{\"tagName\":\"div\",\"selector\":\"foContent\",\"style\":{\"width\":\"100%\",\"height\":\"100%\"}}]}]},\"attrs\":{\"fo\":{\"width\":120,\"height\":30,\"x\":60,\"y\":-15}}},\"router\":{\"name\":\"manhattan\",\"args\":{\"startDirections\":[\"right\"],\"endDirections\":[\"left\"]}},\"connector\":{\"name\":\"rounded\",\"args\":{\"radius\":5}},\"zIndex\":0,\"source\":{\"cell\":\"9eea5d17-151a-4f98-8404-b901024f6c90\",\"port\":\"a155a91a-b790-494b-8abb-d9a37cdc29f2\"},\"target\":{\"cell\":\"72f49566-f6f7-425e-b5ec-bc89ace846f6\",\"port\":\"8fe0a21f-1d09-41c5-a23b-8e45187bd119\"}},{\"shape\":\"edge\",\"attrs\":{\"line\":{\"stroke\":\"#999999\",\"targetMarker\":{\"name\":\"block\",\"size\":8}}},\"id\":\"930eae66-73b8-4394-abf2-87596afbdff4\",\"defaultLabel\":{\"markup\":{\"tagName\":\"foreignObject\",\"selector\":\"fo\",\"children\":[{\"ns\":\"http://www.w3.org/1999/xhtml\",\"tagName\":\"body\",\"selector\":\"foBody\",\"attrs\":{\"xmlns\":\"http://www.w3.org/1999/xhtml\"},\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"background\":\"transparent\"},\"children\":[{\"tagName\":\"div\",\"selector\":\"foContent\",\"style\":{\"width\":\"100%\",\"height\":\"100%\"}}]}]},\"attrs\":{\"fo\":{\"width\":120,\"height\":30,\"x\":60,\"y\":-15}}},\"router\":{\"name\":\"manhattan\",\"args\":{\"startDirections\":[\"right\"],\"endDirections\":[\"left\"]}},\"connector\":{\"name\":\"rounded\",\"args\":{\"radius\":5}},\"zIndex\":0,\"source\":{\"cell\":\"72f49566-f6f7-425e-b5ec-bc89ace846f6\",\"port\":\"f9609290-40b7-47f8-8c2f-4371f63a529c\"},\"target\":{\"cell\":\"1124de4c-98df-4a8a-a819-50d429f77c9c\",\"port\":\"7b08d1d1-9893-4feb-a103-b6446d05d611\"}},{\"shape\":\"edge\",\"attrs\":{\"line\":{\"stroke\":\"#999999\",\"targetMarker\":{\"name\":\"block\",\"size\":8}}},\"id\":\"db3afab0-6a25-4814-9a2c-fc2b285e6eb8\",\"defaultLabel\":{\"markup\":{\"tagName\":\"foreignObject\",\"selector\":\"fo\",\"children\":[{\"ns\":\"http://www.w3.org/1999/xhtml\",\"tagName\":\"body\",\"selector\":\"foBody\",\"attrs\":{\"xmlns\":\"http://www.w3.org/1999/xhtml\"},\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"background\":\"transparent\"},\"children\":[{\"tagName\":\"div\",\"selector\":\"foContent\",\"style\":{\"width\":\"100%\",\"height\":\"100%\"}}]}]},\"attrs\":{\"fo\":{\"width\":120,\"height\":30,\"x\":60,\"y\":-15}}},\"router\":{\"name\":\"manhattan\",\"args\":{\"startDirections\":[\"right\"],\"endDirections\":[\"left\"]}},\"connector\":{\"name\":\"rounded\",\"args\":{\"radius\":5}},\"zIndex\":0,\"source\":{\"cell\":\"1124de4c-98df-4a8a-a819-50d429f77c9c\",\"port\":\"a1b848f6-c084-40f9-a861-760851a477df\"},\"target\":{\"cell\":\"6d7608ba-8873-41b3-9951-799413304241\",\"port\":\"8ffa0f26-b67c-4811-8047-a3a6954e2e51\"}},{\"shape\":\"edge\",\"attrs\":{\"line\":{\"stroke\":\"#999999\",\"targetMarker\":{\"name\":\"block\",\"size\":8}}},\"id\":\"87aa9074-d972-4afc-9380-1c4d7c59d1c5\",\"defaultLabel\":{\"markup\":{\"tagName\":\"foreignObject\",\"selector\":\"fo\",\"children\":[{\"ns\":\"http://www.w3.org/1999/xhtml\",\"tagName\":\"body\",\"selector\":\"foBody\",\"attrs\":{\"xmlns\":\"http://www.w3.org/1999/xhtml\"},\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"background\":\"transparent\"},\"children\":[{\"tagName\":\"div\",\"selector\":\"foContent\",\"style\":{\"width\":\"100%\",\"height\":\"100%\"}}]}]},\"attrs\":{\"fo\":{\"width\":120,\"height\":30,\"x\":60,\"y\":-15}}},\"router\":{\"name\":\"manhattan\",\"args\":{\"startDirections\":[\"right\"],\"endDirections\":[\"left\"]}},\"connector\":{\"name\":\"rounded\",\"args\":{\"radius\":5}},\"zIndex\":0,\"source\":{\"cell\":\"6d7608ba-8873-41b3-9951-799413304241\",\"port\":\"b08fcf28-4458-4bdd-a002-39455f4c2ff5\"},\"target\":{\"cell\":\"ec68da27-8a81-4aad-a522-8150074328f2\",\"port\":\"d1b77bd7-53ec-405e-936d-05f083d23585\"}},{\"position\":{\"x\":-1043.75,\"y\":-480},\"size\":{\"width\":199.732666015625,\"height\":40},\"view\":\"vue-shape-view\",\"shape\":\"vue-shape\",\"id\":\"48797311-2f85-45a2-ab90-875759c3d1a4\",\"component\":\"dropdown-component-TABLE_INPUT\",\"data\":{\"stages\":{\"dagId\":\"11ed4a12fe97ef26b3ee1df8b8dd6145\",\"stageId\":\"48797311-2f85-45a2-ab90-875759c3d1a4\",\"checkPassed\":true,\"remark\":\"\",\"remarkVisible\":true,\"componentType\":\"SOURCE\",\"configPageCode\":\"TABLE_INPUT\",\"configPageCodeName\":\"TABLE_INPUT\",\"configuration\":{\"query\":\"select * from \\\"ods\\\".\\\"ods_sjzt_fkjg_bmzclx_xmry\\\"\",\"name\":\"表输入_部门累计值\",\"queryTimeout\":60,\"isOutPuts\":false,\"datasourceName\":\"工时数仓(gp)\",\"schemaName\":\"ods\",\"tableName\":\"ods_sjzt_fkjg_bmzclx_xmry\",\"businessSystemId\":\"1e6cb02b462345eba15f734b723457c6\",\"datasourceType\":\"Greenplum\",\"datasourceId\":\"12386e4567d922eba15f612c11ddae17\",\"schemaId\":\"11ecfcca54207843a31f21803dd30ca1\",\"tableId\":\"11ed4a1397b72687b433cf04894ec13d\",\"dataBaseType\":null,\"driver\":\"com.pivotal.jdbc.GreenplumDriver\",\"url\":\"jdbc:postgresql://192.168.58.27:5432/yuannian?gssEncMode=disable\",\"user\":\"gpadmin\",\"password\":\"P5YtcBDeK8k0Q33vULNr/8d1P+VDNdQ5Tljk371VoP4=\",\"dbtable\":\"ods_sjzt_fkjg_bmzclx_xmry\",\"dbtableId\":\"11ed4a1397b72687b433cf04894ec13d\"},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"表输入_部门累计值\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.jdbc.greenplum.GreenplumSource\",\"input_point_ids\":[],\"out_point_ids\":[\"d14abfad-f87f-479d-8c5b-8d268ec8722b\"],\"inputLanes\":[],\"outputLanes\":[\"d14abfad-f87f-479d-8c5b-8d268ec8722b\"]}},\"zIndex\":1,\"mouseleave\":1665575750514,\"mousedown\":1665575749489,\"mousemove\":1665575750095,\"mouseup\":1665575750335,\"ports\":{\"groups\":{\"in\":{\"position\":\"left\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"connectionCount\":1,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}},\"out\":{\"position\":\"right\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}}},\"items\":[{\"group\":\"out\",\"id\":\"d14abfad-f87f-479d-8c5b-8d268ec8722b\"}]}},{\"position\":{\"x\":-1071.25,\"y\":-314},\"size\":{\"width\":217.232666015625,\"height\":40},\"view\":\"vue-shape-view\",\"shape\":\"vue-shape\",\"id\":\"e5ce16d6-8dcd-4021-83c0-476b5f69f8cc\",\"component\":\"dropdown-component-TABLE_INPUT\",\"data\":{\"stages\":{\"dagId\":\"11ed4a12fe97ef26b3ee1df8b8dd6145\",\"stageId\":\"e5ce16d6-8dcd-4021-83c0-476b5f69f8cc\",\"checkPassed\":true,\"remark\":\"\",\"remarkVisible\":true,\"componentType\":\"SOURCE\",\"configPageCode\":\"TABLE_INPUT\",\"configPageCodeName\":\"TABLE_INPUT\",\"configuration\":{\"query\":\"select * from \\\"ods\\\".\\\"ods_sjzt_xg_fzcube_xsjl_xsx\\\"\",\"name\":\"表输入_部门代签已签\",\"queryTimeout\":60,\"isOutPuts\":false,\"datasourceName\":\"工时数仓(gp)\",\"schemaName\":\"ods\",\"tableName\":\"ods_sjzt_xg_fzcube_xsjl_xsx\",\"businessSystemId\":\"1e6cb02b462345eba15f734b723457c6\",\"datasourceType\":\"Greenplum\",\"datasourceId\":\"12386e4567d922eba15f612c11ddae17\",\"schemaId\":\"11ecfcca54207843a31f21803dd30ca1\",\"tableId\":\"11ed4a13c65b7568b433c5e37d8b6053\",\"dataBaseType\":null,\"driver\":\"com.pivotal.jdbc.GreenplumDriver\",\"url\":\"jdbc:postgresql://192.168.58.27:5432/yuannian?gssEncMode=disable\",\"user\":\"gpadmin\",\"password\":\"P5YtcBDeK8k0Q33vULNr/8d1P+VDNdQ5Tljk371VoP4=\",\"dbtable\":\"ods_sjzt_xg_fzcube_xsjl_xsx\",\"dbtableId\":\"11ed4a13c65b7568b433c5e37d8b6053\"},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"表输入_部门代签已签\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.jdbc.greenplum.GreenplumSource\",\"input_point_ids\":[],\"out_point_ids\":[\"dd8c28d4-6976-4db3-a050-a77b38110971\"],\"inputLanes\":[],\"outputLanes\":[\"dd8c28d4-6976-4db3-a050-a77b38110971\"]}},\"zIndex\":2,\"mouseleave\":1665575621916,\"mousedown\":1665575144435,\"mousemove\":1665575144954,\"mouseup\":1665575145160,\"ports\":{\"groups\":{\"in\":{\"position\":\"left\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"connectionCount\":1,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}},\"out\":{\"position\":\"right\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}}},\"items\":[{\"group\":\"out\",\"id\":\"dd8c28d4-6976-4db3-a050-a77b38110971\"}]}},{\"position\":{\"x\":-579,\"y\":-480},\"size\":{\"width\":172.5,\"height\":40},\"view\":\"vue-shape-view\",\"shape\":\"vue-shape\",\"id\":\"9eea5d17-151a-4f98-8404-b901024f6c90\",\"component\":\"dropdown-component-SQL_SCRIPT\",\"data\":{\"stages\":{\"dagId\":\"11ed4a12fe97ef26b3ee1df8b8dd6145\",\"stageId\":\"9eea5d17-151a-4f98-8404-b901024f6c90\",\"checkPassed\":true,\"remark\":\"\",\"remarkVisible\":true,\"componentType\":\"PROCESS\",\"configPageCode\":\"SQL_SCRIPT\",\"configPageCodeName\":\"SQL_SCRIPT\",\"configuration\":{\"sqlScript\":\"select \\n    YEAR,\\n    MONTH, \\n    ENTITY_NAME,\\n    ENTITY_CODE, \\n    sum(cast(P_VALUE as float)) as sum_acc\\nfrom ods_sjzt_fkjg_bmzclx_xmry\\ngroup by YEAR, MONTH, ENTITY_NAME, ENTITY_CODE\",\"tableInfo\":[{\"tableName\":\"ods_sjzt_fkjg_bmzclx_xmry\",\"lane\":\"d14abfad-f87f-479d-8c5b-8d268ec8722b\",\"isActive\":true}]},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"部门累计值计算\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.sql.SparkSqlScriptProcessor\",\"input_point_ids\":[\"54f4ad44-affc-430f-8591-d04bc387bc7d\"],\"out_point_ids\":[\"a155a91a-b790-494b-8abb-d9a37cdc29f2\"],\"inputLanes\":[\"d14abfad-f87f-479d-8c5b-8d268ec8722b\"],\"outputLanes\":[\"a155a91a-b790-494b-8abb-d9a37cdc29f2\"]}},\"zIndex\":3,\"mouseleave\":1665576048044,\"mousedown\":1665575748509,\"mousemove\":1665575748686,\"mouseup\":1665575748881,\"ports\":{\"groups\":{\"in\":{\"position\":\"left\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"connectionCount\":1,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}},\"out\":{\"position\":\"right\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}}},\"items\":[{\"group\":\"in\",\"id\":\"54f4ad44-affc-430f-8591-d04bc387bc7d\",\"connected\":true},{\"group\":\"out\",\"id\":\"a155a91a-b790-494b-8abb-d9a37cdc29f2\"}]}},{\"position\":{\"x\":-804.482421875,\"y\":-314},\"size\":{\"width\":155,\"height\":40},\"view\":\"vue-shape-view\",\"shape\":\"vue-shape\",\"id\":\"58f178ec-4011-4d30-a8a3-22f1913119df\",\"component\":\"dropdown-component-SQL_SCRIPT\",\"data\":{\"stages\":{\"dagId\":\"11ed4a12fe97ef26b3ee1df8b8dd6145\",\"stageId\":\"58f178ec-4011-4d30-a8a3-22f1913119df\",\"checkPassed\":true,\"remark\":\"\",\"remarkVisible\":true,\"componentType\":\"PROCESS\",\"configPageCode\":\"SQL_SCRIPT\",\"configPageCodeName\":\"SQL_SCRIPT\",\"configuration\":{\"sqlScript\":\"select\\n    t.OBJECT_ID,\\n    t.TJ_KJ,\\n    t.FX_KJ,\\n    t.YEAR,\\n    t.MONTH,\\n    t.INTEGRATED,\\n    t.STANDBY_DIM,\\n    t.RY,\\n    case\\n      when(length(t.XSBM_CODE) >9 )\\n        then substring(t.XSBM_CODE,1,9)\\n      else t.XSBM_CODE\\n    end  as org_code,\\n    \\n    t.XSBM_NAME,\\n    t.SJMC,\\n    t.SJZT,\\n    t.P_VALUE,\\n    t.CREATE_DATE\\nfrom ods_sjzt_xg_fzcube_xsjl_xsx t\",\"tableInfo\":[{\"tableName\":\"ods_sjzt_xg_fzcube_xsjl_xsx\",\"lane\":\"dd8c28d4-6976-4db3-a050-a77b38110971\",\"isActive\":true}]},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"清洗组织部门\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.sql.SparkSqlScriptProcessor\",\"input_point_ids\":[\"e68e3657-83ce-4348-8b62-3ad3a10726b7\"],\"out_point_ids\":[\"4cf4474c-1286-4a91-9c1f-44bec7dc5420\"],\"inputLanes\":[\"dd8c28d4-6976-4db3-a050-a77b38110971\"],\"outputLanes\":[\"4cf4474c-1286-4a91-9c1f-44bec7dc5420\"]}},\"zIndex\":4,\"mouseleave\":1665575149349,\"mousedown\":1665575145776,\"mousemove\":1665575148804,\"mouseup\":1665575149232,\"ports\":{\"groups\":{\"in\":{\"position\":\"left\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"connectionCount\":1,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}},\"out\":{\"position\":\"right\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}}},\"items\":[{\"group\":\"in\",\"id\":\"e68e3657-83ce-4348-8b62-3ad3a10726b7\",\"connected\":true},{\"group\":\"out\",\"id\":\"4cf4474c-1286-4a91-9c1f-44bec7dc5420\"}]}},{\"position\":{\"x\":-579,\"y\":-314},\"size\":{\"width\":210.42236328125,\"height\":40},\"view\":\"vue-shape-view\",\"shape\":\"vue-shape\",\"id\":\"63a631d9-3f71-41d8-bc28-fd77668e9277\",\"component\":\"dropdown-component-SQL_SCRIPT\",\"data\":{\"stages\":{\"dagId\":\"11ed4a12fe97ef26b3ee1df8b8dd6145\",\"stageId\":\"63a631d9-3f71-41d8-bc28-fd77668e9277\",\"checkPassed\":true,\"remark\":\"\",\"remarkVisible\":true,\"componentType\":\"PROCESS\",\"configPageCode\":\"SQL_SCRIPT\",\"configPageCodeName\":\"SQL_SCRIPT\",\"configuration\":{\"sqlScript\":\"select YEAR,MONTH,XSBM_NAME,org_code,RY,sum(P_VALUE) as sales_sum from sum_sale_month group by YEAR,MONTH,XSBM_NAME,org_code,RY\",\"tableInfo\":[{\"tableName\":\"sum_sale_month\",\"lane\":\"4cf4474c-1286-4a91-9c1f-44bec7dc5420\",\"isActive\":true}]},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"计算待签已签T3之和\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.sql.SparkSqlScriptProcessor\",\"input_point_ids\":[\"12c0b840-9b15-43bb-a0b3-4754f421bf0a\"],\"out_point_ids\":[\"9d3149f6-1bd6-4107-8105-7302e763fb37\"],\"inputLanes\":[\"4cf4474c-1286-4a91-9c1f-44bec7dc5420\"],\"outputLanes\":[\"9d3149f6-1bd6-4107-8105-7302e763fb37\"]}},\"zIndex\":8,\"mouseleave\":1665578667246,\"mousedown\":1665575150027,\"mousemove\":1665575151670,\"mouseup\":1665575151968,\"ports\":{\"groups\":{\"in\":{\"position\":\"left\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"connectionCount\":1,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}},\"out\":{\"position\":\"right\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}}},\"items\":[{\"group\":\"in\",\"id\":\"12c0b840-9b15-43bb-a0b3-4754f421bf0a\",\"connected\":true},{\"group\":\"out\",\"id\":\"9d3149f6-1bd6-4107-8105-7302e763fb37\"}]}},{\"position\":{\"x\":-310,\"y\":-410},\"size\":{\"width\":137.5,\"height\":40},\"view\":\"vue-shape-view\",\"shape\":\"vue-shape\",\"id\":\"72f49566-f6f7-425e-b5ec-bc89ace846f6\",\"component\":\"dropdown-component-SQL_SCRIPT\",\"data\":{\"stages\":{\"dagId\":\"11ed4a12fe97ef26b3ee1df8b8dd6145\",\"stageId\":\"72f49566-f6f7-425e-b5ec-bc89ace846f6\",\"checkPassed\":true,\"remark\":\"\",\"remarkVisible\":true,\"componentType\":\"PROCESS\",\"configPageCode\":\"SQL_SCRIPT\",\"configPageCodeName\":\"SQL_SCRIPT\",\"configuration\":{\"sqlScript\":\"select \\n   org_total.YEAR,\\n   org_total.MONTH,\\n   org_total.ENTITY_NAME,\\n   org_total.ENTITY_CODE,\\n   org_total.sum_acc,\\n   sales_month.RY,\\n   sales_month.sales_sum,\\n   (sales_month.sales_sum / org_total.sum_acc) as ratio  \\n  \\nfrom  org_total  \\njoin sales_sum_detail_month sales_month on  \\n((org_total.YEAR = sales_month.YEAR) and (org_total.MONTH = sales_month.MONTH) and (org_total.ENTITY_CODE=sales_month.org_code))\",\"tableInfo\":[{\"tableName\":\"org_total\",\"lane\":\"a155a91a-b790-494b-8abb-d9a37cdc29f2\",\"isActive\":true},{\"tableName\":\"sales_sum_detail_month\",\"lane\":\"9d3149f6-1bd6-4107-8105-7302e763fb37\",\"isActive\":false}]},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"计算可控率\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.sql.SparkSqlScriptProcessor\",\"input_point_ids\":[\"8860719b-5b3a-4add-8fc1-ea17e919f60b\"],\"out_point_ids\":[\"f9609290-40b7-47f8-8c2f-4371f63a529c\"],\"inputLanes\":[\"a155a91a-b790-494b-8abb-d9a37cdc29f2\",\"9d3149f6-1bd6-4107-8105-7302e763fb37\"],\"outputLanes\":[\"f9609290-40b7-47f8-8c2f-4371f63a529c\"]}},\"zIndex\":9,\"mouseleave\":1665578759124,\"mousedown\":1665575152909,\"mousemove\":1665575153846,\"mouseup\":1665575154264,\"ports\":{\"groups\":{\"in\":{\"position\":\"left\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"connectionCount\":1,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}},\"out\":{\"position\":\"right\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}}},\"items\":[{\"group\":\"out\",\"id\":\"f9609290-40b7-47f8-8c2f-4371f63a529c\"},{\"group\":\"in\",\"id\":\"8fe0a21f-1d09-41c5-a23b-8e45187bd119\",\"connected\":true},{\"group\":\"in\",\"id\":\"ac84fa78-32f5-49d7-8a16-c851b3ddb7da\",\"connected\":true}]}},{\"position\":{\"x\":-112,\"y\":-410},\"size\":{\"width\":137.5,\"height\":40},\"view\":\"vue-shape-view\",\"shape\":\"vue-shape\",\"id\":\"1124de4c-98df-4a8a-a819-50d429f77c9c\",\"component\":\"dropdown-component-SQL_SCRIPT\",\"data\":{\"stages\":{\"dagId\":\"11ed4a12fe97ef26b3ee1df8b8dd6145\",\"stageId\":\"1124de4c-98df-4a8a-a819-50d429f77c9c\",\"checkPassed\":true,\"remark\":\"\",\"remarkVisible\":true,\"componentType\":\"PROCESS\",\"configPageCode\":\"SQL_SCRIPT\",\"configPageCodeName\":\"SQL_SCRIPT\",\"configuration\":{\"sqlScript\":\"select \\nDENSE_RANK()\\n       OVER (partition by t.YEAR,t.MONTH,t.ENTITY_CODE order by t.ratio desc ) as order_num,\\n        t.*\\n from org_ratio t\",\"tableInfo\":[{\"tableName\":\"org_ratio\",\"lane\":\"f9609290-40b7-47f8-8c2f-4371f63a529c\",\"isActive\":true}]},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"排序可控率\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.sql.SparkSqlScriptProcessor\",\"input_point_ids\":[\"7b08d1d1-9893-4feb-a103-b6446d05d611\"],\"out_point_ids\":[\"a1b848f6-c084-40f9-a861-760851a477df\"],\"inputLanes\":[\"f9609290-40b7-47f8-8c2f-4371f63a529c\"],\"outputLanes\":[\"a1b848f6-c084-40f9-a861-760851a477df\"]}},\"zIndex\":10,\"mouseleave\":1665648295790,\"mousedown\":1665575161113,\"mousemove\":1665575162529,\"mouseup\":1665575162848,\"ports\":{\"groups\":{\"in\":{\"position\":\"left\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"connectionCount\":1,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}},\"out\":{\"position\":\"right\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}}},\"items\":[{\"group\":\"in\",\"id\":\"7b08d1d1-9893-4feb-a103-b6446d05d611\",\"connected\":true},{\"group\":\"out\",\"id\":\"a1b848f6-c084-40f9-a861-760851a477df\"}]}},{\"position\":{\"x\":78,\"y\":-410},\"size\":{\"width\":203.248046875,\"height\":40},\"view\":\"vue-shape-view\",\"shape\":\"vue-shape\",\"id\":\"6d7608ba-8873-41b3-9951-799413304241\",\"component\":\"dropdown-component-SQL_SCRIPT\",\"data\":{\"stages\":{\"dagId\":\"11ed4a12fe97ef26b3ee1df8b8dd6145\",\"stageId\":\"6d7608ba-8873-41b3-9951-799413304241\",\"checkPassed\":true,\"remark\":\"\",\"remarkVisible\":true,\"componentType\":\"PROCESS\",\"configPageCode\":\"SQL_SCRIPT\",\"configPageCodeName\":\"SQL_SCRIPT\",\"configuration\":{\"sqlScript\":\"select \\nt.order_num as rank_order_num,\\nt.YEAR as rank_year,\\nt.MONTH as rank_month,\\nt.ENTITY_NAME as department_name,\\nt.ENTITY_CODE as department_code,\\nt.sum_acc,\\nt.RY as staff_name_code,\\nt.sales_sum,\\nt.ratio\\nfrom org_sales_ratio_rank t  where order_num < 6 -- 限制每个部门显示的条数\",\"tableInfo\":[{\"tableName\":\"org_sales_ratio_rank\",\"lane\":\"a1b848f6-c084-40f9-a861-760851a477df\",\"isActive\":true}]},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"部门销售可控率topn排名\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.sql.SparkSqlScriptProcessor\",\"input_point_ids\":[\"8ffa0f26-b67c-4811-8047-a3a6954e2e51\"],\"out_point_ids\":[\"b08fcf28-4458-4bdd-a002-39455f4c2ff5\"],\"inputLanes\":[\"a1b848f6-c084-40f9-a861-760851a477df\"],\"outputLanes\":[\"b08fcf28-4458-4bdd-a002-39455f4c2ff5\"]}},\"zIndex\":11,\"mouseleave\":1665648296521,\"mousedown\":1665648296080,\"mousemove\":1665575165459,\"mouseup\":1665648296168,\"ports\":{\"groups\":{\"in\":{\"position\":\"left\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"connectionCount\":1,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}},\"out\":{\"position\":\"right\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}}},\"items\":[{\"group\":\"in\",\"id\":\"8ffa0f26-b67c-4811-8047-a3a6954e2e51\",\"connected\":true},{\"group\":\"out\",\"id\":\"b08fcf28-4458-4bdd-a002-39455f4c2ff5\"}]}},{\"position\":{\"x\":460,\"y\":-410},\"size\":{\"width\":135,\"height\":40},\"view\":\"vue-shape-view\",\"shape\":\"vue-shape\",\"id\":\"ec68da27-8a81-4aad-a522-8150074328f2\",\"component\":\"dropdown-component-TABLE_OUTPUT\",\"data\":{\"stages\":{\"dagId\":\"11ed4a12fe97ef26b3ee1df8b8dd6145\",\"stageId\":\"ec68da27-8a81-4aad-a522-8150074328f2\",\"checkPassed\":true,\"remark\":\"\",\"remarkVisible\":true,\"componentType\":\"SINK\",\"configPageCode\":\"TABLE_OUTPUT\",\"configPageCodeName\":\"TABLE_OUTPUT\",\"configuration\":{\"name\":\"表输出\",\"isDynamic\":0,\"model\":\"overwrite\",\"isOutPuts\":false,\"datasourceName\":\"工时数仓(gp)\",\"schemaName\":\"dws\",\"tableName\":\"dws_cost_sales_ratio_rank_day_al\",\"businessSystemId\":\"1e6cb02b462345eba15f734b723457c6\",\"datasourceType\":\"Greenplum\",\"datasourceId\":\"12386e4567d922eba15f612c11ddae17\",\"schemaId\":\"11ecfccf827f1933a31f1d3be54d445b\",\"tableId\":\"11ed4a2be436f7c8b4330da14e641695\",\"dataBaseType\":null,\"driver\":\"com.pivotal.jdbc.GreenplumDriver\",\"dbtable\":\"\\\"dws\\\".\\\"dws_cost_sales_ratio_rank_day_al\\\"\",\"url\":\"jdbc:postgresql://192.168.58.27:5432/yuannian?gssEncMode=disable\",\"user\":\"gpadmin\",\"password\":\"P5YtcBDeK8k0Q33vULNr/8d1P+VDNdQ5Tljk371VoP4=\",\"dbtableId\":\"11ed4a2be436f7c8b4330da14e641695\"},\"maxInputPoint\":1,\"maxOutputPoint\":0,\"name\":\"表输出\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.jdbc.greenplum.GreenplumTarget\",\"input_point_ids\":[\"d1b77bd7-53ec-405e-936d-05f083d23585\"],\"out_point_ids\":[],\"inputLanes\":[\"b08fcf28-4458-4bdd-a002-39455f4c2ff5\"],\"outputLanes\":[]}},\"zIndex\":12,\"mouseleave\":1665578820561,\"ports\":{\"groups\":{\"in\":{\"position\":\"left\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"connectionCount\":1,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}},\"out\":{\"position\":\"right\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}}},\"items\":[{\"group\":\"in\",\"id\":\"d1b77bd7-53ec-405e-936d-05f083d23585\",\"connected\":true}]}}]}",
            "createBy": "11ec0008a7d6e713ac562bef87a44fb9",
            "updateBy": "11ec0008a7d6e713ac562bef87a44fb9",
            "dagJson": "{\"enableHive\":true,\"logLevel\":\"INFO\",\"parameters\":{},\"sparkConfig\":{\"spark.master\":\"yarn\",\"sparkConfig\":{}},\"stages\":[{\"dagId\":\"11ed4a12fe97ef26b3ee1df8b8dd6145\",\"stageId\":\"48797311-2f85-45a2-ab90-875759c3d1a4\",\"checkPassed\":true,\"remark\":\"\",\"remarkVisible\":true,\"componentType\":\"SOURCE\",\"configPageCode\":\"TABLE_INPUT\",\"configPageCodeName\":\"TABLE_INPUT\",\"configuration\":{\"query\":\"select * from \\\"ods\\\".\\\"ods_sjzt_fkjg_bmzclx_xmry\\\"\",\"name\":\"表输入_部门累计值\",\"queryTimeout\":60,\"isOutPuts\":false,\"datasourceName\":\"工时数仓(gp)\",\"schemaName\":\"ods\",\"tableName\":\"ods_sjzt_fkjg_bmzclx_xmry\",\"businessSystemId\":\"1e6cb02b462345eba15f734b723457c6\",\"datasourceType\":\"Greenplum\",\"datasourceId\":\"12386e4567d922eba15f612c11ddae17\",\"schemaId\":\"11ecfcca54207843a31f21803dd30ca1\",\"tableId\":\"11ed4a1397b72687b433cf04894ec13d\",\"dataBaseType\":null,\"driver\":\"com.pivotal.jdbc.GreenplumDriver\",\"url\":\"jdbc:postgresql://192.168.58.27:5432/yuannian?gssEncMode=disable\",\"user\":\"gpadmin\",\"password\":\"P5YtcBDeK8k0Q33vULNr/8d1P+VDNdQ5Tljk371VoP4=\",\"dbtable\":\"ods_sjzt_fkjg_bmzclx_xmry\",\"dbtableId\":\"11ed4a1397b72687b433cf04894ec13d\"},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"表输入_部门累计值\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.jdbc.greenplum.GreenplumSource\",\"input_point_ids\":[],\"out_point_ids\":[\"d14abfad-f87f-479d-8c5b-8d268ec8722b\"],\"inputLanes\":[],\"outputLanes\":[\"d14abfad-f87f-479d-8c5b-8d268ec8722b\"]},{\"dagId\":\"11ed4a12fe97ef26b3ee1df8b8dd6145\",\"stageId\":\"e5ce16d6-8dcd-4021-83c0-476b5f69f8cc\",\"checkPassed\":true,\"remark\":\"\",\"remarkVisible\":true,\"componentType\":\"SOURCE\",\"configPageCode\":\"TABLE_INPUT\",\"configPageCodeName\":\"TABLE_INPUT\",\"configuration\":{\"query\":\"select * from \\\"ods\\\".\\\"ods_sjzt_xg_fzcube_xsjl_xsx\\\"\",\"name\":\"表输入_部门代签已签\",\"queryTimeout\":60,\"isOutPuts\":false,\"datasourceName\":\"工时数仓(gp)\",\"schemaName\":\"ods\",\"tableName\":\"ods_sjzt_xg_fzcube_xsjl_xsx\",\"businessSystemId\":\"1e6cb02b462345eba15f734b723457c6\",\"datasourceType\":\"Greenplum\",\"datasourceId\":\"12386e4567d922eba15f612c11ddae17\",\"schemaId\":\"11ecfcca54207843a31f21803dd30ca1\",\"tableId\":\"11ed4a13c65b7568b433c5e37d8b6053\",\"dataBaseType\":null,\"driver\":\"com.pivotal.jdbc.GreenplumDriver\",\"url\":\"jdbc:postgresql://192.168.58.27:5432/yuannian?gssEncMode=disable\",\"user\":\"gpadmin\",\"password\":\"P5YtcBDeK8k0Q33vULNr/8d1P+VDNdQ5Tljk371VoP4=\",\"dbtable\":\"ods_sjzt_xg_fzcube_xsjl_xsx\",\"dbtableId\":\"11ed4a13c65b7568b433c5e37d8b6053\"},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"表输入_部门代签已签\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.jdbc.greenplum.GreenplumSource\",\"input_point_ids\":[],\"out_point_ids\":[\"dd8c28d4-6976-4db3-a050-a77b38110971\"],\"inputLanes\":[],\"outputLanes\":[\"dd8c28d4-6976-4db3-a050-a77b38110971\"]},{\"dagId\":\"11ed4a12fe97ef26b3ee1df8b8dd6145\",\"stageId\":\"9eea5d17-151a-4f98-8404-b901024f6c90\",\"checkPassed\":true,\"remark\":\"\",\"remarkVisible\":true,\"componentType\":\"PROCESS\",\"configPageCode\":\"SQL_SCRIPT\",\"configPageCodeName\":\"SQL_SCRIPT\",\"configuration\":{\"sqlScript\":\"select \\n    YEAR,\\n    MONTH, \\n    ENTITY_NAME,\\n    ENTITY_CODE, \\n    sum(cast(P_VALUE as float)) as sum_acc\\nfrom ods_sjzt_fkjg_bmzclx_xmry\\ngroup by YEAR, MONTH, ENTITY_NAME, ENTITY_CODE\",\"tableInfo\":[{\"tableName\":\"ods_sjzt_fkjg_bmzclx_xmry\",\"lane\":\"d14abfad-f87f-479d-8c5b-8d268ec8722b\",\"isActive\":true}]},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"部门累计值计算\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.sql.SparkSqlScriptProcessor\",\"input_point_ids\":[\"54f4ad44-affc-430f-8591-d04bc387bc7d\"],\"out_point_ids\":[\"a155a91a-b790-494b-8abb-d9a37cdc29f2\"],\"inputLanes\":[\"d14abfad-f87f-479d-8c5b-8d268ec8722b\"],\"outputLanes\":[\"a155a91a-b790-494b-8abb-d9a37cdc29f2\"]},{\"dagId\":\"11ed4a12fe97ef26b3ee1df8b8dd6145\",\"stageId\":\"58f178ec-4011-4d30-a8a3-22f1913119df\",\"checkPassed\":true,\"remark\":\"\",\"remarkVisible\":true,\"componentType\":\"PROCESS\",\"configPageCode\":\"SQL_SCRIPT\",\"configPageCodeName\":\"SQL_SCRIPT\",\"configuration\":{\"sqlScript\":\"select\\n    t.OBJECT_ID,\\n    t.TJ_KJ,\\n    t.FX_KJ,\\n    t.YEAR,\\n    t.MONTH,\\n    t.INTEGRATED,\\n    t.STANDBY_DIM,\\n    t.RY,\\n    case\\n      when(length(t.XSBM_CODE) >9 )\\n        then substring(t.XSBM_CODE,1,9)\\n      else t.XSBM_CODE\\n    end  as org_code,\\n    \\n    t.XSBM_NAME,\\n    t.SJMC,\\n    t.SJZT,\\n    t.P_VALUE,\\n    t.CREATE_DATE\\nfrom ods_sjzt_xg_fzcube_xsjl_xsx t\",\"tableInfo\":[{\"tableName\":\"ods_sjzt_xg_fzcube_xsjl_xsx\",\"lane\":\"dd8c28d4-6976-4db3-a050-a77b38110971\",\"isActive\":true}]},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"清洗组织部门\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.sql.SparkSqlScriptProcessor\",\"input_point_ids\":[\"e68e3657-83ce-4348-8b62-3ad3a10726b7\"],\"out_point_ids\":[\"4cf4474c-1286-4a91-9c1f-44bec7dc5420\"],\"inputLanes\":[\"dd8c28d4-6976-4db3-a050-a77b38110971\"],\"outputLanes\":[\"4cf4474c-1286-4a91-9c1f-44bec7dc5420\"]},{\"dagId\":\"11ed4a12fe97ef26b3ee1df8b8dd6145\",\"stageId\":\"63a631d9-3f71-41d8-bc28-fd77668e9277\",\"checkPassed\":true,\"remark\":\"\",\"remarkVisible\":true,\"componentType\":\"PROCESS\",\"configPageCode\":\"SQL_SCRIPT\",\"configPageCodeName\":\"SQL_SCRIPT\",\"configuration\":{\"sqlScript\":\"select YEAR,MONTH,XSBM_NAME,org_code,RY,sum(P_VALUE) as sales_sum from sum_sale_month group by YEAR,MONTH,XSBM_NAME,org_code,RY\",\"tableInfo\":[{\"tableName\":\"sum_sale_month\",\"lane\":\"4cf4474c-1286-4a91-9c1f-44bec7dc5420\",\"isActive\":true}]},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"计算待签已签T3之和\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.sql.SparkSqlScriptProcessor\",\"input_point_ids\":[\"12c0b840-9b15-43bb-a0b3-4754f421bf0a\"],\"out_point_ids\":[\"9d3149f6-1bd6-4107-8105-7302e763fb37\"],\"inputLanes\":[\"4cf4474c-1286-4a91-9c1f-44bec7dc5420\"],\"outputLanes\":[\"9d3149f6-1bd6-4107-8105-7302e763fb37\"]},{\"dagId\":\"11ed4a12fe97ef26b3ee1df8b8dd6145\",\"stageId\":\"72f49566-f6f7-425e-b5ec-bc89ace846f6\",\"checkPassed\":true,\"remark\":\"\",\"remarkVisible\":true,\"componentType\":\"PROCESS\",\"configPageCode\":\"SQL_SCRIPT\",\"configPageCodeName\":\"SQL_SCRIPT\",\"configuration\":{\"sqlScript\":\"select \\n   org_total.YEAR,\\n   org_total.MONTH,\\n   org_total.ENTITY_NAME,\\n   org_total.ENTITY_CODE,\\n   org_total.sum_acc,\\n   sales_month.RY,\\n   sales_month.sales_sum,\\n   (sales_month.sales_sum / org_total.sum_acc) as ratio  \\n  \\nfrom  org_total  \\njoin sales_sum_detail_month sales_month on  \\n((org_total.YEAR = sales_month.YEAR) and (org_total.MONTH = sales_month.MONTH) and (org_total.ENTITY_CODE=sales_month.org_code))\",\"tableInfo\":[{\"tableName\":\"org_total\",\"lane\":\"a155a91a-b790-494b-8abb-d9a37cdc29f2\",\"isActive\":true},{\"tableName\":\"sales_sum_detail_month\",\"lane\":\"9d3149f6-1bd6-4107-8105-7302e763fb37\",\"isActive\":false}]},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"计算可控率\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.sql.SparkSqlScriptProcessor\",\"input_point_ids\":[\"8860719b-5b3a-4add-8fc1-ea17e919f60b\"],\"out_point_ids\":[\"f9609290-40b7-47f8-8c2f-4371f63a529c\"],\"inputLanes\":[\"a155a91a-b790-494b-8abb-d9a37cdc29f2\",\"9d3149f6-1bd6-4107-8105-7302e763fb37\"],\"outputLanes\":[\"f9609290-40b7-47f8-8c2f-4371f63a529c\"]},{\"dagId\":\"11ed4a12fe97ef26b3ee1df8b8dd6145\",\"stageId\":\"1124de4c-98df-4a8a-a819-50d429f77c9c\",\"checkPassed\":true,\"remark\":\"\",\"remarkVisible\":true,\"componentType\":\"PROCESS\",\"configPageCode\":\"SQL_SCRIPT\",\"configPageCodeName\":\"SQL_SCRIPT\",\"configuration\":{\"sqlScript\":\"select \\nDENSE_RANK()\\n       OVER (partition by t.YEAR,t.MONTH,t.ENTITY_CODE order by t.ratio desc ) as order_num,\\n        t.*\\n from org_ratio t\",\"tableInfo\":[{\"tableName\":\"org_ratio\",\"lane\":\"f9609290-40b7-47f8-8c2f-4371f63a529c\",\"isActive\":true}]},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"排序可控率\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.sql.SparkSqlScriptProcessor\",\"input_point_ids\":[\"7b08d1d1-9893-4feb-a103-b6446d05d611\"],\"out_point_ids\":[\"a1b848f6-c084-40f9-a861-760851a477df\"],\"inputLanes\":[\"f9609290-40b7-47f8-8c2f-4371f63a529c\"],\"outputLanes\":[\"a1b848f6-c084-40f9-a861-760851a477df\"]},{\"dagId\":\"11ed4a12fe97ef26b3ee1df8b8dd6145\",\"stageId\":\"6d7608ba-8873-41b3-9951-799413304241\",\"checkPassed\":true,\"remark\":\"\",\"remarkVisible\":true,\"componentType\":\"PROCESS\",\"configPageCode\":\"SQL_SCRIPT\",\"configPageCodeName\":\"SQL_SCRIPT\",\"configuration\":{\"sqlScript\":\"select \\nt.order_num as rank_order_num,\\nt.YEAR as rank_year,\\nt.MONTH as rank_month,\\nt.ENTITY_NAME as department_name,\\nt.ENTITY_CODE as department_code,\\nt.sum_acc,\\nt.RY as staff_name_code,\\nt.sales_sum,\\nt.ratio\\nfrom org_sales_ratio_rank t  where order_num < 6 -- 限制每个部门显示的条数\",\"tableInfo\":[{\"tableName\":\"org_sales_ratio_rank\",\"lane\":\"a1b848f6-c084-40f9-a861-760851a477df\",\"isActive\":true}]},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"部门销售可控率topn排名\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.sql.SparkSqlScriptProcessor\",\"input_point_ids\":[\"8ffa0f26-b67c-4811-8047-a3a6954e2e51\"],\"out_point_ids\":[\"b08fcf28-4458-4bdd-a002-39455f4c2ff5\"],\"inputLanes\":[\"a1b848f6-c084-40f9-a861-760851a477df\"],\"outputLanes\":[\"b08fcf28-4458-4bdd-a002-39455f4c2ff5\"]},{\"dagId\":\"11ed4a12fe97ef26b3ee1df8b8dd6145\",\"stageId\":\"ec68da27-8a81-4aad-a522-8150074328f2\",\"checkPassed\":true,\"remark\":\"\",\"remarkVisible\":true,\"componentType\":\"SINK\",\"configPageCode\":\"TABLE_OUTPUT\",\"configPageCodeName\":\"TABLE_OUTPUT\",\"configuration\":{\"name\":\"表输出\",\"isDynamic\":0,\"model\":\"overwrite\",\"isOutPuts\":false,\"datasourceName\":\"工时数仓(gp)\",\"schemaName\":\"dws\",\"tableName\":\"dws_cost_sales_ratio_rank_day_al\",\"businessSystemId\":\"1e6cb02b462345eba15f734b723457c6\",\"datasourceType\":\"Greenplum\",\"datasourceId\":\"12386e4567d922eba15f612c11ddae17\",\"schemaId\":\"11ecfccf827f1933a31f1d3be54d445b\",\"tableId\":\"11ed4a2be436f7c8b4330da14e641695\",\"dataBaseType\":null,\"driver\":\"com.pivotal.jdbc.GreenplumDriver\",\"dbtable\":\"\\\"dws\\\".\\\"dws_cost_sales_ratio_rank_day_al\\\"\",\"url\":\"jdbc:postgresql://192.168.58.27:5432/yuannian?gssEncMode=disable\",\"user\":\"gpadmin\",\"password\":\"P5YtcBDeK8k0Q33vULNr/8d1P+VDNdQ5Tljk371VoP4=\",\"dbtableId\":\"11ed4a2be436f7c8b4330da14e641695\"},\"maxInputPoint\":1,\"maxOutputPoint\":0,\"name\":\"表输出\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.jdbc.greenplum.GreenplumTarget\",\"input_point_ids\":[\"d1b77bd7-53ec-405e-936d-05f083d23585\"],\"out_point_ids\":[],\"inputLanes\":[\"b08fcf28-4458-4bdd-a002-39455f4c2ff5\"],\"outputLanes\":[]}],\"objectId\":\"11ed4a12fe97ef26b3ee1df8b8dd6145\"}",
            "tenantId": "system",
            "objectId": "11ed4a12fe97ef26b3ee1df8b8dd6145",
            "createDate": "2022-10-12 17:48:15"
        },
        {
            "updateDate": "2022-09-30 16:53:42",
            "pOrgId": "",
            "updateLogin": "jiangshan",
            "pAppId": "",
            "externalParameter": "",
            "versionNumber": 189,
            "pDeleted": "FALSE",
            "graphJson": "{\"cells\":[{\"shape\":\"edge\",\"attrs\":{\"line\":{\"stroke\":\"#999999\",\"targetMarker\":{\"name\":\"block\",\"size\":8}}},\"id\":\"fbed0eaf-2230-49d7-b1bf-be7d06f200dc\",\"defaultLabel\":{\"markup\":{\"tagName\":\"foreignObject\",\"selector\":\"fo\",\"children\":[{\"ns\":\"http://www.w3.org/1999/xhtml\",\"tagName\":\"body\",\"selector\":\"foBody\",\"attrs\":{\"xmlns\":\"http://www.w3.org/1999/xhtml\"},\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"background\":\"transparent\"},\"children\":[{\"tagName\":\"div\",\"selector\":\"foContent\",\"style\":{\"width\":\"100%\",\"height\":\"100%\"}}]}]},\"attrs\":{\"fo\":{\"width\":120,\"height\":30,\"x\":60,\"y\":-15}}},\"router\":{\"name\":\"manhattan\",\"args\":{\"startDirections\":[\"right\"],\"endDirections\":[\"left\"]}},\"connector\":{\"name\":\"rounded\",\"args\":{\"radius\":5}},\"zIndex\":0,\"source\":{\"cell\":\"b38342eb-cf6c-4c11-9166-640c1a626e52\",\"port\":\"55331083-3122-4ccf-a7c9-c62bd9e31f2b\"},\"target\":{\"cell\":\"2e512fb5-a48d-4a5e-b975-70dd027148aa\",\"port\":\"4b66299f-8882-4b1f-9050-d96fdf78096d\"}},{\"shape\":\"edge\",\"attrs\":{\"line\":{\"stroke\":\"#999999\",\"targetMarker\":{\"name\":\"block\",\"size\":8}}},\"id\":\"39a88f85-52c4-4a11-a3ab-180277e2f3ea\",\"defaultLabel\":{\"markup\":{\"tagName\":\"foreignObject\",\"selector\":\"fo\",\"children\":[{\"ns\":\"http://www.w3.org/1999/xhtml\",\"tagName\":\"body\",\"selector\":\"foBody\",\"attrs\":{\"xmlns\":\"http://www.w3.org/1999/xhtml\"},\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"background\":\"transparent\"},\"children\":[{\"tagName\":\"div\",\"selector\":\"foContent\",\"style\":{\"width\":\"100%\",\"height\":\"100%\"}}]}]},\"attrs\":{\"fo\":{\"width\":120,\"height\":30,\"x\":60,\"y\":-15}}},\"router\":{\"name\":\"manhattan\",\"args\":{\"startDirections\":[\"right\"],\"endDirections\":[\"left\"]}},\"connector\":{\"name\":\"rounded\",\"args\":{\"radius\":5}},\"zIndex\":0,\"source\":{\"cell\":\"b5828548-0b4d-4060-b54b-d2f4e97af87b\",\"port\":\"27786ca8-f569-49c8-864a-f5f3b04cabd4\"},\"target\":{\"cell\":\"2e512fb5-a48d-4a5e-b975-70dd027148aa\",\"port\":\"4bd3457d-bd24-4a34-8d1e-3b5a8223c8e6\"}},{\"shape\":\"edge\",\"attrs\":{\"line\":{\"stroke\":\"#999999\",\"targetMarker\":{\"name\":\"block\",\"size\":8}}},\"id\":\"9c3cfd25-21bb-4ba9-9f16-5dc9675cc51b\",\"defaultLabel\":{\"markup\":{\"tagName\":\"foreignObject\",\"selector\":\"fo\",\"children\":[{\"ns\":\"http://www.w3.org/1999/xhtml\",\"tagName\":\"body\",\"selector\":\"foBody\",\"attrs\":{\"xmlns\":\"http://www.w3.org/1999/xhtml\"},\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"background\":\"transparent\"},\"children\":[{\"tagName\":\"div\",\"selector\":\"foContent\",\"style\":{\"width\":\"100%\",\"height\":\"100%\"}}]}]},\"attrs\":{\"fo\":{\"width\":120,\"height\":30,\"x\":60,\"y\":-15}}},\"router\":{\"name\":\"manhattan\",\"args\":{\"startDirections\":[\"right\"],\"endDirections\":[\"left\"]}},\"connector\":{\"name\":\"rounded\",\"args\":{\"radius\":5}},\"zIndex\":0,\"source\":{\"cell\":\"b38342eb-cf6c-4c11-9166-640c1a626e52\",\"port\":\"55331083-3122-4ccf-a7c9-c62bd9e31f2b\"},\"target\":{\"cell\":\"197b2446-f7cb-425c-8432-1eb1f9dd4a50\",\"port\":\"f4f26eaf-8afe-4cb6-9cbb-f4271be55751\"}},{\"shape\":\"edge\",\"attrs\":{\"line\":{\"stroke\":\"#999999\",\"targetMarker\":{\"name\":\"block\",\"size\":8}}},\"id\":\"4f1f6619-93a7-4bf8-a3e4-9c08549020d2\",\"defaultLabel\":{\"markup\":{\"tagName\":\"foreignObject\",\"selector\":\"fo\",\"children\":[{\"ns\":\"http://www.w3.org/1999/xhtml\",\"tagName\":\"body\",\"selector\":\"foBody\",\"attrs\":{\"xmlns\":\"http://www.w3.org/1999/xhtml\"},\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"background\":\"transparent\"},\"children\":[{\"tagName\":\"div\",\"selector\":\"foContent\",\"style\":{\"width\":\"100%\",\"height\":\"100%\"}}]}]},\"attrs\":{\"fo\":{\"width\":120,\"height\":30,\"x\":60,\"y\":-15}}},\"router\":{\"name\":\"manhattan\",\"args\":{\"startDirections\":[\"right\"],\"endDirections\":[\"left\"]}},\"connector\":{\"name\":\"rounded\",\"args\":{\"radius\":5}},\"zIndex\":0,\"source\":{\"cell\":\"b5828548-0b4d-4060-b54b-d2f4e97af87b\",\"port\":\"27786ca8-f569-49c8-864a-f5f3b04cabd4\"},\"target\":{\"cell\":\"197b2446-f7cb-425c-8432-1eb1f9dd4a50\",\"port\":\"910be5b5-d727-462d-b533-0bf7d3ef5a43\"}},{\"shape\":\"edge\",\"attrs\":{\"line\":{\"stroke\":\"#999999\",\"targetMarker\":{\"name\":\"block\",\"size\":8}}},\"id\":\"69f5512c-d2fc-466c-84af-fd114c38cd47\",\"defaultLabel\":{\"markup\":{\"tagName\":\"foreignObject\",\"selector\":\"fo\",\"children\":[{\"ns\":\"http://www.w3.org/1999/xhtml\",\"tagName\":\"body\",\"selector\":\"foBody\",\"attrs\":{\"xmlns\":\"http://www.w3.org/1999/xhtml\"},\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"background\":\"transparent\"},\"children\":[{\"tagName\":\"div\",\"selector\":\"foContent\",\"style\":{\"width\":\"100%\",\"height\":\"100%\"}}]}]},\"attrs\":{\"fo\":{\"width\":120,\"height\":30,\"x\":60,\"y\":-15}}},\"router\":{\"name\":\"manhattan\",\"args\":{\"startDirections\":[\"right\"],\"endDirections\":[\"left\"]}},\"connector\":{\"name\":\"rounded\",\"args\":{\"radius\":5}},\"zIndex\":0,\"source\":{\"cell\":\"396b221e-fcb3-4421-8ae2-293ef591bf66\",\"port\":\"74905d03-2c25-4d11-85ec-54c18670c72c\"},\"target\":{\"cell\":\"668762a4-9769-44df-8d76-596668e03878\",\"port\":\"22d1335a-f11a-4e0a-b75d-e68468aebf2c\"}},{\"shape\":\"edge\",\"attrs\":{\"line\":{\"stroke\":\"#999999\",\"targetMarker\":{\"name\":\"block\",\"size\":8}}},\"id\":\"fa9f7393-a303-471f-9d1c-47bc431e912a\",\"defaultLabel\":{\"markup\":{\"tagName\":\"foreignObject\",\"selector\":\"fo\",\"children\":[{\"ns\":\"http://www.w3.org/1999/xhtml\",\"tagName\":\"body\",\"selector\":\"foBody\",\"attrs\":{\"xmlns\":\"http://www.w3.org/1999/xhtml\"},\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"background\":\"transparent\"},\"children\":[{\"tagName\":\"div\",\"selector\":\"foContent\",\"style\":{\"width\":\"100%\",\"height\":\"100%\"}}]}]},\"attrs\":{\"fo\":{\"width\":120,\"height\":30,\"x\":60,\"y\":-15}}},\"router\":{\"name\":\"manhattan\",\"args\":{\"startDirections\":[\"right\"],\"endDirections\":[\"left\"]}},\"connector\":{\"name\":\"rounded\",\"args\":{\"radius\":5}},\"zIndex\":0,\"source\":{\"cell\":\"668762a4-9769-44df-8d76-596668e03878\",\"port\":\"7ec706f0-ea90-472f-a463-611a68c7f157\"},\"target\":{\"cell\":\"0c05d367-1e9e-4ebd-9d33-5384fb927d86\",\"port\":\"637b2ad7-b38d-41f5-bf91-e28e782bf0e9\"}},{\"shape\":\"edge\",\"attrs\":{\"line\":{\"stroke\":\"#999999\",\"targetMarker\":{\"name\":\"block\",\"size\":8}}},\"id\":\"cf214fb4-9b60-4dd8-b9e3-21cce743bdf5\",\"defaultLabel\":{\"markup\":{\"tagName\":\"foreignObject\",\"selector\":\"fo\",\"children\":[{\"ns\":\"http://www.w3.org/1999/xhtml\",\"tagName\":\"body\",\"selector\":\"foBody\",\"attrs\":{\"xmlns\":\"http://www.w3.org/1999/xhtml\"},\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"background\":\"transparent\"},\"children\":[{\"tagName\":\"div\",\"selector\":\"foContent\",\"style\":{\"width\":\"100%\",\"height\":\"100%\"}}]}]},\"attrs\":{\"fo\":{\"width\":120,\"height\":30,\"x\":60,\"y\":-15}}},\"router\":{\"name\":\"manhattan\",\"args\":{\"startDirections\":[\"right\"],\"endDirections\":[\"left\"]}},\"connector\":{\"name\":\"rounded\",\"args\":{\"radius\":5}},\"zIndex\":0,\"source\":{\"cell\":\"65bea34e-286c-4e76-9926-5d32d82ff32c\",\"port\":\"ae9d9209-f647-4564-a425-d06a715f245c\"},\"target\":{\"cell\":\"0c05d367-1e9e-4ebd-9d33-5384fb927d86\",\"port\":\"d314aa19-af50-4d04-8088-392a1ed051f8\"}},{\"shape\":\"edge\",\"attrs\":{\"line\":{\"stroke\":\"#999999\",\"targetMarker\":{\"name\":\"block\",\"size\":8}}},\"id\":\"f684a519-4238-4ebc-9a15-81685a9529d9\",\"defaultLabel\":{\"markup\":{\"tagName\":\"foreignObject\",\"selector\":\"fo\",\"children\":[{\"ns\":\"http://www.w3.org/1999/xhtml\",\"tagName\":\"body\",\"selector\":\"foBody\",\"attrs\":{\"xmlns\":\"http://www.w3.org/1999/xhtml\"},\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"background\":\"transparent\"},\"children\":[{\"tagName\":\"div\",\"selector\":\"foContent\",\"style\":{\"width\":\"100%\",\"height\":\"100%\"}}]}]},\"attrs\":{\"fo\":{\"width\":120,\"height\":30,\"x\":60,\"y\":-15}}},\"router\":{\"name\":\"manhattan\",\"args\":{\"startDirections\":[\"right\"],\"endDirections\":[\"left\"]}},\"connector\":{\"name\":\"rounded\",\"args\":{\"radius\":5}},\"zIndex\":0,\"source\":{\"cell\":\"00574896-9086-475c-aa37-961245331607\",\"port\":\"831c240f-6fc9-491b-89c3-085f6aa41251\"},\"target\":{\"cell\":\"668762a4-9769-44df-8d76-596668e03878\",\"port\":\"bacc32f6-3235-45b7-a88a-88eaba0ca09d\"}},{\"shape\":\"edge\",\"attrs\":{\"line\":{\"stroke\":\"#999999\",\"targetMarker\":{\"name\":\"block\",\"size\":8}}},\"id\":\"9dcc6bee-5a82-48c9-9074-dd8469359ba4\",\"defaultLabel\":{\"markup\":{\"tagName\":\"foreignObject\",\"selector\":\"fo\",\"children\":[{\"ns\":\"http://www.w3.org/1999/xhtml\",\"tagName\":\"body\",\"selector\":\"foBody\",\"attrs\":{\"xmlns\":\"http://www.w3.org/1999/xhtml\"},\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"background\":\"transparent\"},\"children\":[{\"tagName\":\"div\",\"selector\":\"foContent\",\"style\":{\"width\":\"100%\",\"height\":\"100%\"}}]}]},\"attrs\":{\"fo\":{\"width\":120,\"height\":30,\"x\":60,\"y\":-15}}},\"router\":{\"name\":\"manhattan\",\"args\":{\"startDirections\":[\"right\"],\"endDirections\":[\"left\"]}},\"connector\":{\"name\":\"rounded\",\"args\":{\"radius\":5}},\"zIndex\":0,\"source\":{\"cell\":\"2e512fb5-a48d-4a5e-b975-70dd027148aa\",\"port\":\"076c5140-d61b-42d9-a701-127e15f76d59\"},\"target\":{\"cell\":\"950c8924-5551-40a4-86b3-bf9197b27fb8\",\"port\":\"6a881a41-31cf-464d-9bf3-9d2882e73bdf\"}},{\"shape\":\"edge\",\"attrs\":{\"line\":{\"stroke\":\"#999999\",\"targetMarker\":{\"name\":\"block\",\"size\":8}}},\"id\":\"8baf3044-4317-4b0c-a761-12dba22927ce\",\"defaultLabel\":{\"markup\":{\"tagName\":\"foreignObject\",\"selector\":\"fo\",\"children\":[{\"ns\":\"http://www.w3.org/1999/xhtml\",\"tagName\":\"body\",\"selector\":\"foBody\",\"attrs\":{\"xmlns\":\"http://www.w3.org/1999/xhtml\"},\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"background\":\"transparent\"},\"children\":[{\"tagName\":\"div\",\"selector\":\"foContent\",\"style\":{\"width\":\"100%\",\"height\":\"100%\"}}]}]},\"attrs\":{\"fo\":{\"width\":120,\"height\":30,\"x\":60,\"y\":-15}}},\"router\":{\"name\":\"manhattan\",\"args\":{\"startDirections\":[\"right\"],\"endDirections\":[\"left\"]}},\"connector\":{\"name\":\"rounded\",\"args\":{\"radius\":5}},\"zIndex\":0,\"source\":{\"cell\":\"197b2446-f7cb-425c-8432-1eb1f9dd4a50\",\"port\":\"0ea45c70-723e-49c7-88dd-28ed9d179883\"},\"target\":{\"cell\":\"950c8924-5551-40a4-86b3-bf9197b27fb8\",\"port\":\"57948312-01df-4697-89cd-1ad56cc8dd67\"}},{\"shape\":\"edge\",\"attrs\":{\"line\":{\"stroke\":\"#999999\",\"targetMarker\":{\"name\":\"block\",\"size\":8}}},\"id\":\"e36bbc9a-54a7-4dab-af27-6c104c1d68d6\",\"defaultLabel\":{\"markup\":{\"tagName\":\"foreignObject\",\"selector\":\"fo\",\"children\":[{\"ns\":\"http://www.w3.org/1999/xhtml\",\"tagName\":\"body\",\"selector\":\"foBody\",\"attrs\":{\"xmlns\":\"http://www.w3.org/1999/xhtml\"},\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"background\":\"transparent\"},\"children\":[{\"tagName\":\"div\",\"selector\":\"foContent\",\"style\":{\"width\":\"100%\",\"height\":\"100%\"}}]}]},\"attrs\":{\"fo\":{\"width\":120,\"height\":30,\"x\":60,\"y\":-15}}},\"router\":{\"name\":\"manhattan\",\"args\":{\"startDirections\":[\"right\"],\"endDirections\":[\"left\"]}},\"connector\":{\"name\":\"rounded\",\"args\":{\"radius\":5}},\"zIndex\":0,\"source\":{\"cell\":\"950c8924-5551-40a4-86b3-bf9197b27fb8\",\"port\":\"bbca9d22-5f11-4ba9-916f-91fbb9b2a98f\"},\"target\":{\"cell\":\"00574896-9086-475c-aa37-961245331607\",\"port\":\"a93bb905-9e10-4bbf-8d13-f1dc45efdb97\"}},{\"shape\":\"edge\",\"attrs\":{\"line\":{\"stroke\":\"#999999\",\"targetMarker\":{\"name\":\"block\",\"size\":8}}},\"id\":\"1ed735d5-ac97-4f5f-9760-511f8025c2b9\",\"defaultLabel\":{\"markup\":{\"tagName\":\"foreignObject\",\"selector\":\"fo\",\"children\":[{\"ns\":\"http://www.w3.org/1999/xhtml\",\"tagName\":\"body\",\"selector\":\"foBody\",\"attrs\":{\"xmlns\":\"http://www.w3.org/1999/xhtml\"},\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"background\":\"transparent\"},\"children\":[{\"tagName\":\"div\",\"selector\":\"foContent\",\"style\":{\"width\":\"100%\",\"height\":\"100%\"}}]}]},\"attrs\":{\"fo\":{\"width\":120,\"height\":30,\"x\":60,\"y\":-15}}},\"router\":{\"name\":\"manhattan\",\"args\":{\"startDirections\":[\"right\"],\"endDirections\":[\"left\"]}},\"connector\":{\"name\":\"rounded\",\"args\":{\"radius\":5}},\"zIndex\":0,\"source\":{\"cell\":\"0c05d367-1e9e-4ebd-9d33-5384fb927d86\",\"port\":\"5d098830-25be-4dbe-abc1-783edbc3d84e\"},\"target\":{\"cell\":\"684080cc-be17-4f73-92bb-348c3b04bb2f\",\"port\":\"b47a3aab-a219-4c6c-920b-cd2ffb3d27c0\"}},{\"shape\":\"edge\",\"attrs\":{\"line\":{\"stroke\":\"#999999\",\"targetMarker\":{\"name\":\"block\",\"size\":8}}},\"id\":\"e225b53d-e93d-4681-9b76-64f1a655f8d6\",\"defaultLabel\":{\"markup\":{\"tagName\":\"foreignObject\",\"selector\":\"fo\",\"children\":[{\"ns\":\"http://www.w3.org/1999/xhtml\",\"tagName\":\"body\",\"selector\":\"foBody\",\"attrs\":{\"xmlns\":\"http://www.w3.org/1999/xhtml\"},\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"background\":\"transparent\"},\"children\":[{\"tagName\":\"div\",\"selector\":\"foContent\",\"style\":{\"width\":\"100%\",\"height\":\"100%\"}}]}]},\"attrs\":{\"fo\":{\"width\":120,\"height\":30,\"x\":60,\"y\":-15}}},\"router\":{\"name\":\"manhattan\",\"args\":{\"startDirections\":[\"right\"],\"endDirections\":[\"left\"]}},\"connector\":{\"name\":\"rounded\",\"args\":{\"radius\":5}},\"zIndex\":0,\"source\":{\"cell\":\"684080cc-be17-4f73-92bb-348c3b04bb2f\",\"port\":\"8799990c-6827-45fd-8329-e56f39f31c33\"},\"target\":{\"cell\":\"e67b9333-6f45-4807-8d3d-814b291d6918\",\"port\":\"c3ff45f4-8a85-4506-b086-dd74c771c11f\"}},{\"position\":{\"x\":-250,\"y\":30},\"size\":{\"width\":197.7861328125,\"height\":40},\"view\":\"vue-shape-view\",\"shape\":\"vue-shape\",\"id\":\"b38342eb-cf6c-4c11-9166-640c1a626e52\",\"component\":\"dropdown-component-TABLE_INPUT\",\"data\":{\"stages\":{\"dagId\":\"11ed0bf19650e159928e7b7d5ec54760\",\"stageId\":\"b38342eb-cf6c-4c11-9166-640c1a626e52\",\"checkPassed\":true,\"componentType\":\"SOURCE\",\"configPageCode\":\"TABLE_INPUT\",\"configPageCodeName\":\"TABLE_INPUT\",\"configuration\":{\"query\":\"select * from \\\"dwd\\\".\\\"dwd_fact_cost_control_detail\\\"\",\"name\":\"表输入_费控分摊明细表\",\"queryTimeout\":7200,\"isOutPuts\":false,\"datasourceName\":\"工时数仓(gp)\",\"schemaName\":\"dwd\",\"tableName\":\"dwd_fact_cost_control_detail\",\"businessSystemId\":\"1e6cb02b462345eba15f734b723457c6\",\"datasourceType\":\"Greenplum\",\"datasourceId\":\"12386e4567d922eba15f612c11ddae17\",\"schemaId\":\"11ecfccdb77d7376a31ffbd550285939\",\"tableId\":\"11ed01bec95ccee4a31fd5fd1a67cc91\",\"dataBaseType\":null,\"driver\":\"com.pivotal.jdbc.GreenplumDriver\",\"url\":\"jdbc:postgresql://192.168.58.27:5432/yuannian?gssEncMode=disable\",\"user\":\"gpadmin\",\"password\":\"P5YtcBDeK8k0Q33vULNr/8d1P+VDNdQ5Tljk371VoP4=\",\"dbtable\":\"dwd_fact_cost_control_detail\",\"dbtableId\":\"11ed01bec95ccee4a31fd5fd1a67cc91\"},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"表输入_费控分摊明细表\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.jdbc.greenplum.GreenplumSource\",\"input_point_ids\":[],\"out_point_ids\":[\"55331083-3122-4ccf-a7c9-c62bd9e31f2b\"],\"inputLanes\":[],\"outputLanes\":[\"55331083-3122-4ccf-a7c9-c62bd9e31f2b\"]}},\"zIndex\":1,\"mouseleave\":1660636370472,\"mousedown\":1660636369145,\"mousemove\":1660636369403,\"mouseup\":1660636370304,\"doubleClick\":1660636357487,\"ports\":{\"groups\":{\"in\":{\"position\":\"left\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"connectionCount\":1,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}},\"out\":{\"position\":\"right\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}}},\"items\":[{\"group\":\"out\",\"id\":\"55331083-3122-4ccf-a7c9-c62bd9e31f2b\"}]}},{\"position\":{\"x\":-208,\"y\":150},\"size\":{\"width\":155.7861328125,\"height\":40},\"view\":\"vue-shape-view\",\"shape\":\"vue-shape\",\"id\":\"b5828548-0b4d-4060-b54b-d2f4e97af87b\",\"component\":\"dropdown-component-TABLE_INPUT\",\"data\":{\"stages\":{\"dagId\":\"11ed0bf19650e159928e7b7d5ec54760\",\"stageId\":\"b5828548-0b4d-4060-b54b-d2f4e97af87b\",\"checkPassed\":true,\"componentType\":\"SOURCE\",\"configPageCode\":\"TABLE_INPUT\",\"configPageCodeName\":\"TABLE_INPUT\",\"configuration\":{\"query\":\"select * from \\\"dwd\\\".\\\"dwd_dim_cost_pay_type\\\"\",\"name\":\"表输入_支出类型\",\"queryTimeout\":7200,\"isOutPuts\":false,\"datasourceName\":\"工时数仓(gp)\",\"schemaName\":\"dwd\",\"tableName\":\"dwd_dim_cost_pay_type\",\"businessSystemId\":\"1e6cb02b462345eba15f734b723457c6\",\"datasourceType\":\"Greenplum\",\"datasourceId\":\"12386e4567d922eba15f612c11ddae17\",\"schemaId\":\"11ecfccdb77d7376a31ffbd550285939\",\"tableId\":\"11ed06442fe25c9ca31fdff60183c513\",\"dataBaseType\":null,\"driver\":\"com.pivotal.jdbc.GreenplumDriver\",\"url\":\"jdbc:postgresql://192.168.58.27:5432/yuannian?gssEncMode=disable\",\"user\":\"gpadmin\",\"password\":\"P5YtcBDeK8k0Q33vULNr/8d1P+VDNdQ5Tljk371VoP4=\",\"dbtable\":\"dwd_dim_cost_pay_type\",\"dbtableId\":\"11ed06442fe25c9ca31fdff60183c513\"},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"表输入_支出类型\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.jdbc.greenplum.GreenplumSource\",\"input_point_ids\":[],\"out_point_ids\":[\"27786ca8-f569-49c8-864a-f5f3b04cabd4\"],\"inputLanes\":[],\"outputLanes\":[\"27786ca8-f569-49c8-864a-f5f3b04cabd4\"]}},\"zIndex\":2,\"mouseleave\":1660897607378,\"mousedown\":1660636363842,\"mousemove\":1660636366874,\"mouseup\":1660636367759,\"ports\":{\"groups\":{\"in\":{\"position\":\"left\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"connectionCount\":1,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}},\"out\":{\"position\":\"right\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}}},\"items\":[{\"group\":\"out\",\"id\":\"27786ca8-f569-49c8-864a-f5f3b04cabd4\"}]}},{\"position\":{\"x\":370,\"y\":400},\"size\":{\"width\":155.7861328125,\"height\":40},\"view\":\"vue-shape-view\",\"shape\":\"vue-shape\",\"id\":\"65bea34e-286c-4e76-9926-5d32d82ff32c\",\"component\":\"dropdown-component-TABLE_INPUT\",\"data\":{\"stages\":{\"dagId\":\"11ed0bf19650e159928e7b7d5ec54760\",\"stageId\":\"65bea34e-286c-4e76-9926-5d32d82ff32c\",\"checkPassed\":true,\"componentType\":\"SOURCE\",\"configPageCode\":\"TABLE_INPUT\",\"configPageCodeName\":\"TABLE_INPUT\",\"configuration\":{\"query\":\"select * from \\\"dwd\\\".\\\"dwd_dim_cost_expense_type\\\"\",\"name\":\"表输入_费用归属\",\"queryTimeout\":7200,\"isOutPuts\":false,\"datasourceName\":\"工时数仓(gp)\",\"schemaName\":\"dwd\",\"tableName\":\"dwd_dim_cost_expense_type\",\"businessSystemId\":\"1e6cb02b462345eba15f734b723457c6\",\"datasourceType\":\"Greenplum\",\"datasourceId\":\"12386e4567d922eba15f612c11ddae17\",\"schemaId\":\"11ecfccdb77d7376a31ffbd550285939\",\"tableId\":\"11ed03e9679ed91fa31f15ab693d4d83\",\"dataBaseType\":null,\"driver\":\"com.pivotal.jdbc.GreenplumDriver\",\"url\":\"jdbc:postgresql://192.168.58.27:5432/yuannian?gssEncMode=disable\",\"user\":\"gpadmin\",\"password\":\"P5YtcBDeK8k0Q33vULNr/8d1P+VDNdQ5Tljk371VoP4=\",\"dbtable\":\"dwd_dim_cost_expense_type\",\"dbtableId\":\"11ed03e9679ed91fa31f15ab693d4d83\"},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"表输入_费用归属\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.jdbc.greenplum.GreenplumSource\",\"input_point_ids\":[],\"out_point_ids\":[\"ae9d9209-f647-4564-a425-d06a715f245c\"],\"inputLanes\":[],\"outputLanes\":[\"ae9d9209-f647-4564-a425-d06a715f245c\"]}},\"zIndex\":4,\"mouseleave\":1664506857310,\"mousedown\":1660636340417,\"mouseup\":1660636340431,\"mousemove\":1660636339944,\"doubleClick\":1660299292646,\"ports\":{\"groups\":{\"in\":{\"position\":\"left\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"connectionCount\":1,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}},\"out\":{\"position\":\"right\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}}},\"items\":[{\"group\":\"out\",\"id\":\"ae9d9209-f647-4564-a425-d06a715f245c\"}]}},{\"position\":{\"x\":1150,\"y\":290},\"size\":{\"width\":162.013671875,\"height\":40},\"view\":\"vue-shape-view\",\"shape\":\"vue-shape\",\"id\":\"0c05d367-1e9e-4ebd-9d33-5384fb927d86\",\"component\":\"dropdown-component-SQL_SCRIPT\",\"data\":{\"stages\":{\"dagId\":\"11ed0bf19650e159928e7b7d5ec54760\",\"stageId\":\"0c05d367-1e9e-4ebd-9d33-5384fb927d86\",\"checkPassed\":true,\"componentType\":\"PROCESS\",\"configPageCode\":\"SQL_SCRIPT\",\"configPageCodeName\":\"SQL_SCRIPT\",\"configuration\":{\"sqlScript\":\"select\\n  t.*, \\n  y.partent_name as cost_f_leveltype_name, --一级费用类型名称\\n  y.partent_code as cost_f_leveltype_code -- 一级费用类型编码\\nfrom dws_cost_department_pay_type t \\nleft join dwd_dim_cost_expense_type y \\non (t.cost_ownership_id = y.OBJECT_ID)\",\"tableInfo\":[{\"tableName\":\"dws_cost_department_pay_type\",\"lane\":\"7ec706f0-ea90-472f-a463-611a68c7f157\",\"isActive\":true},{\"tableName\":\"dwd_dim_cost_expense_type\",\"lane\":\"ae9d9209-f647-4564-a425-d06a715f245c\",\"isActive\":false}]},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"SQL组件费用归属\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.sql.SparkSqlScriptProcessor\",\"input_point_ids\":[\"f80a818c-1167-4efc-98ca-ecc0ba9ad968\"],\"out_point_ids\":[\"5d098830-25be-4dbe-abc1-783edbc3d84e\"],\"inputLanes\":[\"7ec706f0-ea90-472f-a463-611a68c7f157\",\"ae9d9209-f647-4564-a425-d06a715f245c\"],\"outputLanes\":[\"5d098830-25be-4dbe-abc1-783edbc3d84e\"]}},\"zIndex\":6,\"mouseleave\":1664524460606,\"mousedown\":1660299396411,\"mousemove\":1660299396959,\"mouseup\":1660299397193,\"doubleClick\":1660299270622,\"ports\":{\"groups\":{\"in\":{\"position\":\"left\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"connectionCount\":1,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}},\"out\":{\"position\":\"right\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}}},\"items\":[{\"group\":\"out\",\"id\":\"5d098830-25be-4dbe-abc1-783edbc3d84e\"},{\"group\":\"in\",\"id\":\"637b2ad7-b38d-41f5-bf91-e28e782bf0e9\",\"connected\":true},{\"group\":\"in\",\"id\":\"d314aa19-af50-4d04-8088-392a1ed051f8\",\"connected\":true}]}},{\"position\":{\"x\":1420,\"y\":290},\"size\":{\"width\":141.85276794433594,\"height\":40},\"view\":\"vue-shape-view\",\"shape\":\"vue-shape\",\"id\":\"684080cc-be17-4f73-92bb-348c3b04bb2f\",\"component\":\"dropdown-component-SQL_SCRIPT\",\"data\":{\"stages\":{\"dagId\":\"11ed0bf19650e159928e7b7d5ec54760\",\"stageId\":\"684080cc-be17-4f73-92bb-348c3b04bb2f\",\"checkPassed\":true,\"componentType\":\"PROCESS\",\"configPageCode\":\"SQL_SCRIPT\",\"configPageCodeName\":\"SQL_SCRIPT\",\"configuration\":{\"sqlScript\":\"select \\n  share_year,\\n  share_month, \\n  org_code,\\n  org_name,\\n  cost_f_leveltype_code,\\n  cost_f_leveltype_name,\\n  cost_s_leveltype_code,\\n  cost_s_leveltype_name,\\n  pay_f_level_code,\\n  pay_f_level_name,\\n  pay_s_level_code,\\n  pay_s_level_name,\\n  sum(document_quantity) document_quantity\\nfrom \\n(\\n  select\\n    share_year as share_year, --年\\n    share_month as share_month, --期间\\n    org_code,\\n    org_name,\\n    cost_f_leveltype_code as cost_f_leveltype_code, --费用归属类型一级编码\\n    cost_f_leveltype_name as cost_f_leveltype_name, --费用归属类型一级名称\\n    cost_s_leveltype_code as cost_s_leveltype_code, --费用归属类型二级编码\\n    cost_s_leveltype_name as cost_s_leveltype_name, --费用归属类型二级名称\\n    pay_f_level_code as pay_f_level_code, --支出类型一级编码\\n    pay_f_level_name as pay_f_level_name, --支出类型一级名称\\n    pay_s_level_code as pay_s_level_code, --支出类型二级编码\\n    pay_s_level_name as pay_s_level_name, --支出类型二级名称\\n    count(distinct bill_code) as document_quantity --单据量\\n  from dws_cost_department_pay_type\\n  group by \\n  share_year,\\n  share_month, \\n  project_code, \\n  project_description,\\n  org_code,\\n  org_name,\\n  cost_f_leveltype_code,\\n  cost_f_leveltype_name,\\n  cost_s_leveltype_code,\\n  cost_s_leveltype_name,\\n  pay_f_level_code,\\n  pay_f_level_name,\\n  pay_s_level_code,\\n  pay_s_level_name \\n) t1\\n  group by \\n  share_year,\\n  share_month, \\n  org_code,\\n  org_name,\\n  cost_f_leveltype_code,\\n  cost_f_leveltype_name,\\n  cost_s_leveltype_code,\\n  cost_s_leveltype_name,\\n  pay_f_level_code,\\n  pay_f_level_name,\\n  pay_s_level_code,\\n  pay_s_level_name \",\"tableInfo\":[{\"tableName\":\"dws_cost_department_pay_type\",\"lane\":\"5d098830-25be-4dbe-abc1-783edbc3d84e\",\"isActive\":true}]},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"SQL组件单据量\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.sql.SparkSqlScriptProcessor\",\"input_point_ids\":[\"1f3170cb-d2ae-4837-a24d-815a74f671c6\"],\"out_point_ids\":[\"8799990c-6827-45fd-8329-e56f39f31c33\"],\"inputLanes\":[\"5d098830-25be-4dbe-abc1-783edbc3d84e\"],\"outputLanes\":[\"8799990c-6827-45fd-8329-e56f39f31c33\"]}},\"zIndex\":7,\"mouseleave\":1664528021221,\"mousedown\":1660299399691,\"mousemove\":1660299400681,\"mouseup\":1660299400961,\"ports\":{\"groups\":{\"in\":{\"position\":\"left\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"connectionCount\":1,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}},\"out\":{\"position\":\"right\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}}},\"items\":[{\"group\":\"out\",\"id\":\"8799990c-6827-45fd-8329-e56f39f31c33\"},{\"group\":\"in\",\"id\":\"b47a3aab-a219-4c6c-920b-cd2ffb3d27c0\",\"connected\":true}]}},{\"position\":{\"x\":1660,\"y\":290},\"size\":{\"width\":281.7861328125,\"height\":40},\"view\":\"vue-shape-view\",\"shape\":\"vue-shape\",\"id\":\"e67b9333-6f45-4807-8d3d-814b291d6918\",\"component\":\"dropdown-component-TABLE_OUTPUT\",\"data\":{\"stages\":{\"dagId\":\"11ed0bf19650e159928e7b7d5ec54760\",\"stageId\":\"e67b9333-6f45-4807-8d3d-814b291d6918\",\"checkPassed\":true,\"componentType\":\"SINK\",\"configPageCode\":\"TABLE_OUTPUT\",\"configPageCodeName\":\"TABLE_OUTPUT\",\"configuration\":{\"name\":\"表输出_部门项目支出类型信息明细表\",\"model\":\"overwrite\",\"isOutPuts\":false,\"datasourceName\":\"工时数仓(gp)\",\"schemaName\":\"dws\",\"tableName\":\"dws_cost_department_pay_type\",\"businessSystemId\":\"1e6cb02b462345eba15f734b723457c6\",\"datasourceType\":\"Greenplum\",\"datasourceId\":\"12386e4567d922eba15f612c11ddae17\",\"schemaId\":\"11ecfccf827f1933a31f1d3be54d445b\",\"tableId\":\"11ed0cb0da5d7abba31f813afcfe46e9\",\"dataBaseType\":null,\"driver\":\"com.pivotal.jdbc.GreenplumDriver\",\"dbtable\":\"\\\"dws\\\".\\\"dws_cost_department_pay_type\\\"\",\"url\":\"jdbc:postgresql://192.168.58.27:5432/yuannian?gssEncMode=disable\",\"user\":\"gpadmin\",\"password\":\"P5YtcBDeK8k0Q33vULNr/8d1P+VDNdQ5Tljk371VoP4=\",\"dbtableId\":\"11ed0cb0da5d7abba31f813afcfe46e9\"},\"maxInputPoint\":1,\"maxOutputPoint\":0,\"name\":\"表输出_部门项目支出类型信息明细表\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.jdbc.greenplum.GreenplumTarget\",\"input_point_ids\":[\"c3ff45f4-8a85-4506-b086-dd74c771c11f\"],\"out_point_ids\":[],\"inputLanes\":[\"8799990c-6827-45fd-8329-e56f39f31c33\"],\"outputLanes\":[]}},\"zIndex\":8,\"mouseleave\":1664528021514,\"mousedown\":1660299401438,\"mousemove\":1660299402395,\"mouseup\":1660299402801,\"doubleClick\":1660297206937,\"ports\":{\"groups\":{\"in\":{\"position\":\"left\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"connectionCount\":1,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}},\"out\":{\"position\":\"right\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}}},\"items\":[{\"group\":\"in\",\"id\":\"c3ff45f4-8a85-4506-b086-dd74c771c11f\",\"connected\":true}]}},{\"position\":{\"x\":860,\"y\":230},\"size\":{\"width\":135,\"height\":40},\"view\":\"vue-shape-view\",\"shape\":\"vue-shape\",\"id\":\"668762a4-9769-44df-8d76-596668e03878\",\"component\":\"dropdown-component-SQL_SCRIPT\",\"data\":{\"stages\":{\"dagId\":\"11ed0bf19650e159928e7b7d5ec54760\",\"stageId\":\"668762a4-9769-44df-8d76-596668e03878\",\"checkPassed\":true,\"componentType\":\"PROCESS\",\"configPageCode\":\"SQL_SCRIPT\",\"configPageCodeName\":\"SQL_SCRIPT\",\"configuration\":{\"sqlScript\":\"select detail.*\\nfrom t_cost_detail detail \\nleft join t_center org \\non org_id = org.department_id\\nwhere org.department_is_leaf = 'TRUE'\",\"tableInfo\":[{\"tableName\":\"t_cost_detail\",\"lane\":\"831c240f-6fc9-491b-89c3-085f6aa41251\",\"isActive\":true},{\"tableName\":\"t_center\",\"lane\":\"74905d03-2c25-4d11-85ec-54c18670c72c\",\"isActive\":false}]},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"清洗末级部门\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.sql.SparkSqlScriptProcessor\",\"input_point_ids\":[\"bacc32f6-3235-45b7-a88a-88eaba0ca09d\"],\"out_point_ids\":[\"7ec706f0-ea90-472f-a463-611a68c7f157\"],\"inputLanes\":[\"831c240f-6fc9-491b-89c3-085f6aa41251\",\"74905d03-2c25-4d11-85ec-54c18670c72c\"],\"outputLanes\":[\"7ec706f0-ea90-472f-a463-611a68c7f157\"]}},\"zIndex\":9,\"mouseleave\":1664524457321,\"mousedown\":1660299397749,\"mousemove\":1660299398715,\"mouseup\":1660299398953,\"ports\":{\"groups\":{\"in\":{\"position\":\"left\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"connectionCount\":1,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}},\"out\":{\"position\":\"right\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}}},\"items\":[{\"group\":\"in\",\"id\":\"bacc32f6-3235-45b7-a88a-88eaba0ca09d\",\"connected\":true},{\"group\":\"out\",\"id\":\"7ec706f0-ea90-472f-a463-611a68c7f157\"},{\"group\":\"in\",\"id\":\"22d1335a-f11a-4e0a-b75d-e68468aebf2c\",\"connected\":true}]}},{\"position\":{\"x\":370,\"y\":310},\"size\":{\"width\":155.7861328125,\"height\":40},\"view\":\"vue-shape-view\",\"shape\":\"vue-shape\",\"id\":\"396b221e-fcb3-4421-8ae2-293ef591bf66\",\"component\":\"dropdown-component-TABLE_INPUT\",\"data\":{\"stages\":{\"dagId\":\"11ed0bf19650e159928e7b7d5ec54760\",\"stageId\":\"396b221e-fcb3-4421-8ae2-293ef591bf66\",\"checkPassed\":true,\"componentType\":\"SOURCE\",\"configPageCode\":\"TABLE_INPUT\",\"configPageCodeName\":\"TABLE_INPUT\",\"configuration\":{\"query\":\"select * from \\\"dwd\\\".\\\"dwd_dim_cost_department_center\\\"\",\"name\":\"表输入_责任中心\",\"queryTimeout\":7200,\"isOutPuts\":false,\"datasourceName\":\"工时数仓(gp)\",\"schemaName\":\"dwd\",\"tableName\":\"dwd_dim_cost_department_center\",\"businessSystemId\":\"1e6cb02b462345eba15f734b723457c6\",\"datasourceType\":\"Greenplum\",\"datasourceId\":\"12386e4567d922eba15f612c11ddae17\",\"schemaId\":\"11ecfccdb77d7376a31ffbd550285939\",\"tableId\":\"11ed03e9679ed91ea31f77625aa005fb\",\"dataBaseType\":null,\"driver\":\"com.pivotal.jdbc.GreenplumDriver\",\"url\":\"jdbc:postgresql://192.168.58.27:5432/yuannian?gssEncMode=disable\",\"user\":\"gpadmin\",\"password\":\"P5YtcBDeK8k0Q33vULNr/8d1P+VDNdQ5Tljk371VoP4=\",\"dbtable\":\"dwd_dim_cost_department_center\",\"dbtableId\":\"11ed03e9679ed91ea31f77625aa005fb\"},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"表输入_责任中心\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.jdbc.greenplum.GreenplumSource\",\"input_point_ids\":[],\"out_point_ids\":[\"74905d03-2c25-4d11-85ec-54c18670c72c\"],\"inputLanes\":[],\"outputLanes\":[\"74905d03-2c25-4d11-85ec-54c18670c72c\"]}},\"zIndex\":10,\"mouseleave\":1664500419240,\"mousedown\":1660636337090,\"mousemove\":1660636336651,\"mouseup\":1660636337103,\"ports\":{\"groups\":{\"in\":{\"position\":\"left\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"connectionCount\":1,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}},\"out\":{\"position\":\"right\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}}},\"items\":[{\"group\":\"out\",\"id\":\"74905d03-2c25-4d11-85ec-54c18670c72c\"}]}},{\"position\":{\"x\":590,\"y\":90},\"size\":{\"width\":162,\"height\":40},\"view\":\"vue-shape-view\",\"shape\":\"vue-shape\",\"id\":\"00574896-9086-475c-aa37-961245331607\",\"component\":\"dropdown-component-SQL_SCRIPT\",\"data\":{\"stages\":{\"dagId\":\"11ed0bf19650e159928e7b7d5ec54760\",\"stageId\":\"00574896-9086-475c-aa37-961245331607\",\"checkPassed\":true,\"componentType\":\"PROCESS\",\"configPageCode\":\"SQL_SCRIPT\",\"configPageCodeName\":\"SQL_SCRIPT\",\"configuration\":{\"sqlScript\":\"select \\n  bill_code,\\n  cost_ownership_id,\\n  share_year,\\n  share_month,\\n  project_code, \\n  project_description,\\n  org_id,\\n  org_code,\\n  org_name,\\n  --cost_firstownership_departmentid,\\n  --cost_firstownership_departmentcode,\\n  --cost_firstownership_departmentname,\\n  --cost_secondownership_departmentid,\\n  --cost_secondownership_departmentcode,\\n  --cost_secondownership_departmentname,\\n  cost_s_leveltype_code,\\n  cost_s_leveltype_name,\\n  pay_f_level_code,\\n  (case\\n    when(pay_s_level_name = '交通类-交通费')\\n        then '交通类'\\n    when(pay_s_level_name = '餐饮类-客户招待')\\n        then '餐饮类'\\n    when(pay_s_level_name = '公共费用-福利费')\\n        then '公共费用'\\n    when(pay_s_level_name = '公共费用-部门（团队）建设费')\\n        then '公共费用'\\n    when(pay_s_level_name = '采购-外包服务费（对公支付）')\\n        then '外包服务费'\\n    when(pay_s_level_name = '采购-外包服务费（对私支付）')\\n        then '外包服务费'\\n    when(pay_s_level_name = '办公-办公用品')\\n        then '办公礼品类' \\n    when(pay_s_level_name = '渠道-佣金费')\\n        then '渠道类'\\n    when(pay_s_level_name = '公共费用-福利费')\\n        then '公共费用'\\n    when(pay_s_level_name = '办公-礼品费')\\n        then '办公礼品类'\\n    else\\n        pay_f_level_name\\n  end) as pay_f_level_name,\\n  pay_s_level_code,\\n  pay_s_level_name\\nfrom t_detail\",\"tableInfo\":[{\"tableName\":\"t_detail\",\"lane\":\"bbca9d22-5f11-4ba9-916f-91fbb9b2a98f\",\"isActive\":true}]},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"清洗支出类型一级\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.sql.SparkSqlScriptProcessor\",\"input_point_ids\":[\"a93bb905-9e10-4bbf-8d13-f1dc45efdb97\"],\"out_point_ids\":[\"831c240f-6fc9-491b-89c3-085f6aa41251\"],\"inputLanes\":[\"bbca9d22-5f11-4ba9-916f-91fbb9b2a98f\"],\"outputLanes\":[\"831c240f-6fc9-491b-89c3-085f6aa41251\"]}},\"zIndex\":11,\"mouseleave\":1664524535222,\"mousedown\":1660633855002,\"mousemove\":1660633855130,\"mouseup\":1660633855509,\"ports\":{\"groups\":{\"in\":{\"position\":\"left\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"connectionCount\":1,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}},\"out\":{\"position\":\"right\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}}},\"items\":[{\"group\":\"in\",\"id\":\"a93bb905-9e10-4bbf-8d13-f1dc45efdb97\",\"connected\":true},{\"group\":\"out\",\"id\":\"831c240f-6fc9-491b-89c3-085f6aa41251\"}]}},{\"position\":{\"x\":90,\"y\":150},\"size\":{\"width\":135,\"height\":40},\"view\":\"vue-shape-view\",\"shape\":\"vue-shape\",\"id\":\"197b2446-f7cb-425c-8432-1eb1f9dd4a50\",\"component\":\"dropdown-component-SQL_SCRIPT\",\"data\":{\"stages\":{\"dagId\":\"11ed0bf19650e159928e7b7d5ec54760\",\"stageId\":\"197b2446-f7cb-425c-8432-1eb1f9dd4a50\",\"checkPassed\":true,\"componentType\":\"PROCESS\",\"configPageCode\":\"SQL_SCRIPT\",\"configPageCodeName\":\"SQL_SCRIPT\",\"configuration\":{\"sqlScript\":\"select\\n\\tt.bill_code ,\\n  t.cost_ownership_id, --费用归属父级ID因业务改动，先只需用二级的ID去关联\\n  t.project_code, \\n  t.project_description,\\n\\tt.business_year as share_year,\\n\\t--年\\n\\tt.business_month as share_month,\\n\\t--期间\\n  t.cost_secondownership_departmentid org_id,\\n  t.cost_secondownership_departmentcode org_code,\\n  -- 因dm模型没有该组织名，所以目前根据code进行清洗成匹配目前的开发环境。在生产环境中可能进行修改\\n   (case \\n    when (t.cost_secondownership_departmentcode='YN001' or t.cost_secondownership_departmentname='综合中心本部')\\n        then '管理团队'\\n      when (t.cost_secondownership_departmentcode='YN026' or t.cost_secondownership_departmentname = '大客户经营二中心本部')\\n        then '大客户经营二中心' \\n      when (t.cost_secondownership_departmentcode='YN003' or t.cost_secondownership_departmentname = '品牌营销中心本部')\\n        then '品牌营销中心'   \\n      when (t.cost_secondownership_departmentcode='YN006' or t.cost_secondownership_departmentname = '研发中心本部')\\n        then '研发中心'\\n      when (t.cost_secondownership_departmentcode='YN016' or t.cost_secondownership_departmentname = '银行行业中心本部')\\n        then '银行行业中心（BK）' \\n      when (t.cost_secondownership_departmentcode='YN024' or t.cost_secondownership_departmentname = '零售快消行业中心本部')\\n        then '零售快消行业中心（RF）' \\n        when (t.cost_secondownership_departmentcode='YN034' or t.cost_secondownership_departmentname = '视觉设计部')\\n        then '视觉设计部' \\n      when (t.cost_secondownership_departmentcode='YN012' or t.cost_secondownership_departmentname = '金融行业中心本部')\\n        then '金融行业中心（FC）' \\n       when (t.cost_secondownership_departmentcode='YN022' or t.cost_secondownership_departmentname = '能源化工行业中心本部')\\n        then '能源化工行业中心（EC）' \\n      when (t.cost_secondownership_departmentcode='YN023' or t.cost_secondownership_departmentname = '装备制造行业中心本部')\\n        then '装备制造行业中心（EM）' \\n       when (t.cost_secondownership_departmentcode='YN011.001' or t.cost_secondownership_departmentname = 'RS华东事业部')\\n        then 'RS华东交付一部' \\n       when (t.cost_secondownership_departmentcode='YN011.002' or t.cost_secondownership_departmentname = 'RS华南事业部')\\n        then 'RS华南交付部' \\n        when (t.cost_secondownership_departmentcode='YN011.004' or t.cost_secondownership_departmentname = 'RS华北事业部')\\n        then 'RS华北交付一部' \\n       when (t.cost_secondownership_departmentcode='YN032.001' or t.cost_secondownership_departmentname = '财务共享产品中心')\\n        then '财务共享产品中心' \\n       when (t.cost_secondownership_departmentcode='YN027.001' or t.cost_secondownership_departmentname = '央企销售部')\\n        then '央企销售部' \\n        when (t.cost_secondownership_departmentcode='YN013' or t.cost_secondownership_departmentname = '大客户经营中心本部')\\n        then '大客户经营中心(KA)' \\n       when (t.cost_secondownership_departmentcode='YN011' or t.cost_secondownership_departmentname = '地产行业中心本部')\\n        then '地产行业中心（RS）' \\n      when (t.cost_secondownership_departmentcode='YN025' or t.cost_secondownership_departmentname = '科技服务行业中心本部')\\n        then '科技服务行业中心（TS）' \\n       when (t.cost_secondownership_departmentcode='YN038.001' or t.cost_secondownership_departmentname = 'RPA产品中心')\\n        then 'RPA产品中心' \\n      when (t.cost_secondownership_departmentcode='YN009' or t.cost_secondownership_departmentname = '解决方案中心本部')\\n        then '解决方案中心' \\n      when (t.cost_secondownership_departmentcode='YN031.001' or t.cost_secondownership_departmentname = '预算产品中心')\\n        then '预算产品中心' \\n       when (t.cost_secondownership_departmentcode='YN035.001' or t.cost_secondownership_departmentname = '采购产品中心')\\n        then '采购产品中心' \\n       when (t.cost_secondownership_departmentcode='YN035.001' or t.cost_secondownership_departmentname = '采购产品中心')\\n        then '采购产品中心' \\n       when (t.cost_secondownership_departmentcode='YN010' or t.cost_secondownership_departmentname = '政府与公共事务中心本部')\\n        then '政府与公共事务中心' \\n       when (t.cost_secondownership_departmentcode='YN041.001' or t.cost_secondownership_departmentname = '物资主数据产品中心')\\n        then '物资主数据产品中心' \\n       when (t.cost_secondownership_departmentcode='YN029' or t.cost_secondownership_departmentname = '管理咨询中心')\\n        then '管理咨询中心本部' \\n      when (t.cost_secondownership_departmentcode='YN037.001' or t.cost_secondownership_departmentname = '商旅产品中心')\\n        then '商旅产品中心' \\n       when (t.cost_secondownership_departmentcode='YN034.001' or t.cost_secondownership_departmentname = '视觉设计部')\\n        then '视觉设计部' \\n        when (t.cost_secondownership_departmentcode='YN033.001' or t.cost_secondownership_departmentname = '方舟平台产品中心')\\n        then '方舟平台产品中心' \\n       when (t.cost_secondownership_departmentcode='YN039.001' or t.cost_secondownership_departmentname = '共享创新业务销售部')\\n        then '共享创新业务销售部' \\n       when (t.cost_secondownership_departmentcode='YN036.001' or t.cost_secondownership_departmentname = '税务产品中心')\\n        then '税务产品中心' \\n       when (t.cost_secondownership_departmentcode='YN028.001' or t.cost_secondownership_departmentname = '西南区销售部')\\n        then '西南区销售部' \\n       when (t.cost_secondownership_departmentcode='YN011.005' or t.cost_secondownership_departmentname = '地产行业发展部')\\n       then '地产研究院' \\n       when (t.cost_secondownership_departmentcode='YN043' or t.cost_secondownership_departmentname = '大客户事业五部（作废）')\\n       then '大客户事业五部' \\n      else t.cost_secondownership_departmentname\\n   end) as org_name, --费用组织二级部门名称\\n  --t.cost_firstownership_departmentid,\\n\\t--t.cost_firstownership_departmentcode as cost_firstownership_departmentcode,\\n\\t--费用归属一级部门编码\\n  --t.cost_firstownership_departmentname,\\n\\t--费用归属一级部门名称\\n  --t.cost_secondownership_departmentid,\\n\\t--t.cost_secondownership_departmentcode as cost_secondownership_departmentcode,\\n\\t--费用归属二级部门编码\\n  --t.cost_secondownership_departmentname as cost_secondownership_departmentname,\\n     case \\n       when t.cost_ownership_name = '研发费用' then '研发费用.'\\n       else t.cost_ownership_name\\n   end as cost_s_leveltype_name,--费用归属二级名称\\n   case \\n       when t.cost_ownership_code = '研发费用' then '研发费用.'\\n       else t.cost_ownership_code\\n   end as cost_s_leveltype_code, --费用归属二级编码\\n\\t--费用归属类型二级名称\\n\\ty.CODE as pay_f_level_code, --支出类型一级编码\\n   (case\\n        when (t.expenditure_type_code= 'DIM_EXP_SCGYBT_001')\\n           then '私车公用'\\n        when (t.expenditure_type_code= 'DIM_EXP_SCGY' and t.bill_code like 'FYBX%')\\n           then '私车公用'   \\n        when  (t.expenditure_type_code= 'DIM_EXP_WWFWF_001')\\n           then '外包服务费'\\n         when  (t.expenditure_type_code= 'DIM_EXP_CGWBFWFDSZF_001')\\n           then '外包服务费'   \\n        else y.NAME    \\n   end) as pay_f_level_name, --支出类型一级名称\\n\\tt.expenditure_type_code as pay_s_level_code, --支出类型二级编码\\n  (case\\n      when (t.bill_code like 'CLBX%' and  t.expenditure_type_code='DIM_EXP_SCGY')\\n        then concat(t.expenditure_type_name,'.')\\n      when (t.bill_code like 'CLBX%' and  t.expenditure_type_code='DIM_EXP_YC_001')\\n        then concat(t.expenditure_type_name,'.')\\n      when (t.bill_code like 'CLBX%' and  t.expenditure_type_code='DIM_EXP_EAT')\\n        then '交通类-交通费.'\\n       when (t.bill_code like 'FYBX%' and  t.expenditure_type_code='DIM_EXP_ZYLHYF_001')\\n        then '渠道-伙伴合作'\\n      when (t.expenditure_type_code = 'DIM_EXP_PPT_001' and  t.expenditure_type_name like '%调研报告%' )\\n         then '品牌-调用报告'\\n      when (t.expenditure_type_code = 'DIM_EXP_ZZZ_001' and t.expenditure_type_name='杂志-资料费')\\n         then '杂志-推广费'\\n      when (t.expenditure_type_code = 'DIM_EXP_ZZC_001' and t.expenditure_type_name='杂志-出刊费')\\n         then '杂志-发行费'\\n      when (t.expenditure_type_code = 'DIM_EXP_QTSK_001' and t.expenditure_type_name='品牌文化-其他书刊')\\n         then '品牌-活动费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_SKSF_001' and t.expenditure_type_name='品牌文化-书刊书费')\\n         then '品牌-活动费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_HD_001' and t.expenditure_type_name='品牌文化-其他活动')\\n         then '品牌-活动费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_HZZF_001' and t.expenditure_type_name='品牌文化-合作政府')\\n         then '品牌-活动费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_WLYXWZYWF_001' and  t.expenditure_type_name='品牌文化-网络营销网站运维费')\\n         then '品牌-平台费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_SKKWF_001' and t.expenditure_type_name='品牌文化-书刊刊物费')\\n         then '品牌-活动费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_HZJG_001' and t.expenditure_type_name='品牌文化-合作机构')\\n         then '品牌-活动费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_XCP_001' and t.expenditure_type_name='品牌文化-宣传品')\\n         then '品牌-营销物料'\\n      when (t.expenditure_type_code = 'DIM_EXP_QTHZ_001' and t.expenditure_type_name='品牌文化-其他合作')\\n         then '品牌-活动费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_HZCS_001' and t.expenditure_type_name='品牌文化-合作厂商')\\n         then '品牌-活动费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_SKZTF_001' and t.expenditure_type_name='品牌文化-书刊专题费')\\n         then '品牌-活动费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_QC' and t.expenditure_type_name='差旅类-汽车')\\n         then '交通类-交通费'\\n      when (t.expenditure_type_code = 'DIM_EXP_DDGRDF' and t.expenditure_type_name='差旅类-滴滴个人垫付')\\n         then '交通类-交通费'\\n      when (t.expenditure_type_code = 'DIM_EXP_DCF_002' and t.expenditure_type_name='交通类-其他交通')\\n         then '交通类-交通费'\\n      when (t.expenditure_type_code = 'DIM_EXP_KHHCP_001' and t.expenditure_type_name='交通类-客户火车票')\\n         then '交通类-交通费'\\n      when (t.expenditure_type_code = 'DIM_EXP_CTQCP_001' and t.expenditure_type_name='交通类-长途汽车票')\\n         then '交通类-交通费'\\n      when (t.expenditure_type_code = 'DIM_EXP_TCJGLGQF_001' and t.expenditure_type_name='交通类-停车及过路过桥费')\\n         then '交通类-交通费'\\n      when (t.expenditure_type_code = 'DIM_EXP_QYZCF_001' and t.expenditure_type_name='交通类-企业租车费')\\n         then '交通类-交通费'\\n      when (t.expenditure_type_code = 'DIM_EXP_JYF_001' and t.expenditure_type_name='交通类-加油费')\\n         then '交通类-交通费'\\n      when (t.expenditure_type_code = 'DIM_EXP_KHJP_001' and t.expenditure_type_name like '%客户机票%')\\n         then '餐饮类-客户招待'\\n      when (t.expenditure_type_code = 'DIM_EXP_KHLC_001' and t.expenditure_type_name='客户轮船')\\n         then '餐饮类-客户招待'\\n      when (t.expenditure_type_code = 'DIM_EXP_YF_001' and t.expenditure_type_name='行政-装修')\\n         then '行政-办公室维护'\\n      when (t.expenditure_type_code = 'DIM_EXP_GSNH_001' and t.expenditure_type_name='行政-公司年会')\\n         then '公共费用-福利费'\\n      when (t.expenditure_type_code = 'DIM_EXP_TJCF_001' and t.expenditure_type_name='餐饮类-团建餐费')\\n         then '公共费用-部门（团队）建设费'\\n      when (t.expenditure_type_code = 'DIM_EXP_WF_001' and t.expenditure_type_name='网费')\\n         then '办公-办公用品'\\n      when (t.expenditure_type_code = 'DIM_EXP_SJDHF_001' and t.expenditure_type_name='手机电话费')\\n         then '办公-办公用品'\\n      when (t.expenditure_type_code = 'DIM_EXP_YJF_001' and t.expenditure_type_name='邮寄费')\\n         then '办公-办公用品'\\n      when (t.expenditure_type_code = 'DIM_EXP_DYFYZD_001' and t.expenditure_type_name='打印复印装订')\\n         then '办公-办公用品'\\n      when (t.expenditure_type_code = 'DIM_EXP_QTBGXGFY_001' and t.expenditure_type_name='办公礼品类-其他办公相关费用')\\n         then '办公-办公用品'\\n      when (t.expenditure_type_code = 'DIM_EXP_DZYH_001' and t.expenditure_type_name='办公礼品类-快递费')\\n         then '办公-办公用品'\\n      when (t.expenditure_type_code = 'DIM_EXP_LPF_001' and t.expenditure_type_name='礼品费')\\n         then '办公-礼品费'\\n      when (t.expenditure_type_code = 'DIM_EXP_SJF_001' and t.expenditure_type_name='采购-图书')\\n         then '办公-办公用品'\\n      when (t.expenditure_type_code = 'DIM_EXP_CGY_001' and t.expenditure_type_name='采购-佣金费')\\n         then '渠道-佣金费'\\n      when (t.expenditure_type_code = 'DIM_EXP_RQF_001' and t.expenditure_type_name='燃气费')\\n         then '租房相关-项目组租房相关费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_LHF_001' and t.expenditure_type_name='绿化费')\\n         then '行政-办公室维护'\\n      when (t.expenditure_type_code = 'DIM_EXP_NQF_001' and t.expenditure_type_name='租房相关-暖气费')\\n         then '租房相关-项目组租房相关费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_SDF_001' and t.expenditure_type_name='租房相关-水电费')\\n         then '租房相关-项目组租房相关费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_BAF_001' and t.expenditure_type_name='租房相关-宽带费')\\n         then '租房相关-项目组租房相关费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_WYF_001' and t.expenditure_type_name='租房相关-物业费')\\n         then '租房相关-项目组租房相关费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_BJF_001' and t.expenditure_type_name='租房相关-床上用品')\\n         then '公共费用-福利费'\\n      when (t.expenditure_type_code = 'DIM_EXP_TXF_001' and t.expenditure_type_name= '公共费用-通讯费')\\n         then '办公-办公用品'\\n      when (t.expenditure_type_code = 'DIM_EXP_JHSYFL_001' and t.expenditure_type_name='公共费用-结婚生育福利')\\n         then '公共费用-福利费'\\n      when (t.expenditure_type_code = 'DIM_EXP_LPFY_001' and t.expenditure_type_name='礼品费')\\n         then '办公-礼品费'\\n      when (t.expenditure_type_code = 'DIM_EXP_XMHDF_001' and t.expenditure_type_name='公共费用-项目活动费')\\n         then '公共费用-福利费'\\n      when (t.expenditure_type_code = 'DIM_EXP_SJF_002' and t.expenditure_type_name='财务-审计费')\\n         then '财务-鉴证咨询'\\n      when (t.expenditure_type_code = 'DIM_EXP_YZF_001' and t.expenditure_type_name='财务-验资费')\\n         then '财务-鉴证咨询'\\n      when (t.expenditure_type_code = 'DIM_EXP_CB_001' and t.expenditure_type_name='云流量-成本')\\n         then '元年云-服务器运营成本'\\n      when (t.expenditure_type_code = 'DIM_EXP_KHZS_001' and t.expenditure_type_name='住宿类-客户住宿')\\n         then '餐饮类-客户招待'\\n    else t.expenditure_type_name\\n  end \\n  ) as pay_s_level_name--支出类型二级名称\\nfrom\\n\\tdwd_fact_cost_control_detail t\\nleft join dwd_dim_cost_pay_type y on\\n\\t(t.expenditure_type_parent_id = y.OBJECT_ID)\\nwhere t.cost_secondownership_departmentid is not null or t.cost_secondownership_departmentid !=''\",\"tableInfo\":[{\"tableName\":\"dwd_dim_cost_pay_type\",\"lane\":\"27786ca8-f569-49c8-864a-f5f3b04cabd4\",\"isActive\":true},{\"tableName\":\"dwd_fact_cost_control_detail\",\"lane\":\"55331083-3122-4ccf-a7c9-c62bd9e31f2b\",\"isActive\":false}]},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"费用归属二级\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.sql.SparkSqlScriptProcessor\",\"input_point_ids\":[\"f4f26eaf-8afe-4cb6-9cbb-f4271be55751\"],\"out_point_ids\":[\"0ea45c70-723e-49c7-88dd-28ed9d179883\"],\"inputLanes\":[\"27786ca8-f569-49c8-864a-f5f3b04cabd4\",\"55331083-3122-4ccf-a7c9-c62bd9e31f2b\"],\"outputLanes\":[\"0ea45c70-723e-49c7-88dd-28ed9d179883\"]}},\"zIndex\":12,\"mouseleave\":1664524428922,\"mousedown\":1660632947798,\"mousemove\":1660632948629,\"mouseup\":1660632948941,\"doubleClick\":1660632861939,\"ports\":{\"groups\":{\"in\":{\"position\":\"left\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"connectionCount\":1,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}},\"out\":{\"position\":\"right\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}}},\"items\":[{\"group\":\"in\",\"id\":\"f4f26eaf-8afe-4cb6-9cbb-f4271be55751\",\"connected\":true},{\"group\":\"out\",\"id\":\"0ea45c70-723e-49c7-88dd-28ed9d179883\"},{\"group\":\"in\",\"id\":\"910be5b5-d727-462d-b533-0bf7d3ef5a43\",\"connected\":true}]}},{\"position\":{\"x\":90,\"y\":30},\"size\":{\"width\":135,\"height\":40},\"view\":\"vue-shape-view\",\"shape\":\"vue-shape\",\"id\":\"2e512fb5-a48d-4a5e-b975-70dd027148aa\",\"component\":\"dropdown-component-SQL_SCRIPT\",\"data\":{\"stages\":{\"dagId\":\"11ed0bf19650e159928e7b7d5ec54760\",\"stageId\":\"2e512fb5-a48d-4a5e-b975-70dd027148aa\",\"checkPassed\":true,\"componentType\":\"PROCESS\",\"configPageCode\":\"SQL_SCRIPT\",\"configPageCodeName\":\"SQL_SCRIPT\",\"configuration\":{\"sqlScript\":\"select\\n\\tt.bill_code ,\\n  t.cost_ownership_id, --费用归属父级ID因业务改动，先只需用二级的ID去关联\\n  t.project_code, \\n  t.project_description,\\n\\tt.business_year as share_year,\\n\\t--年\\n\\tt.business_month as share_month,\\n\\t--期间\\n  t.cost_firstownership_departmentid org_id,\\n  t.cost_firstownership_departmentcode org_code,\\n  -- 上生产后可能进行修改\\n  (case \\n      when (t.cost_firstownership_departmentcode='YN001' or t.cost_firstownership_departmentname='综合中心本部')\\n        then '管理团队'\\n      when (t.cost_firstownership_departmentcode='YN026' or t.cost_firstownership_departmentname = '大客户经营二中心本部')\\n        then '大客户经营二中心' \\n      when (t.cost_firstownership_departmentcode='YN003' or t.cost_firstownership_departmentname = '品牌营销中心本部')\\n        then '品牌营销中心'   \\n      when (t.cost_firstownership_departmentcode='YN006' or t.cost_firstownership_departmentname = '研发中心本部')\\n        then '研发中心'\\n      when (t.cost_firstownership_departmentcode='YN016' or t.cost_firstownership_departmentname = '银行行业中心本部')\\n        then '银行行业中心（BK）' \\n      when (t.cost_firstownership_departmentcode='YN024' or t.cost_firstownership_departmentname = '零售快消行业中心本部')\\n        then '零售快消行业中心（RF）' \\n        when (t.cost_firstownership_departmentcode='YN034' or t.cost_firstownership_departmentname = '视觉设计部')\\n        then '视觉设计部' \\n      when (t.cost_firstownership_departmentcode='YN012' or t.cost_firstownership_departmentname = '金融行业中心本部')\\n        then '金融行业中心（FC）' \\n       when (t.cost_firstownership_departmentcode='YN022' or t.cost_firstownership_departmentname = '能源化工行业中心本部')\\n        then '能源化工行业中心（EC）' \\n      when (t.cost_firstownership_departmentcode='YN023' or t.cost_firstownership_departmentname = '装备制造行业中心本部')\\n        then '装备制造行业中心（EM）' \\n       when (t.cost_firstownership_departmentcode='YN011.001' or t.cost_firstownership_departmentname = 'RS华东事业部')\\n        then 'RS华东交付一部' \\n       when (t.cost_firstownership_departmentcode='YN011.002' or t.cost_firstownership_departmentname = 'RS华南事业部')\\n        then 'RS华南交付部' \\n        when (t.cost_firstownership_departmentcode='YN011.004' or t.cost_firstownership_departmentname = 'RS华北事业部')\\n        then 'RS华北交付一部' \\n       when (t.cost_firstownership_departmentcode='YN032.001' or t.cost_firstownership_departmentname = '财务共享产品中心')\\n        then '财务共享产品中心' \\n       when (t.cost_firstownership_departmentcode='YN027.001' or t.cost_firstownership_departmentname = '央企销售部')\\n        then '央企销售部' \\n        when (t.cost_firstownership_departmentcode='YN013' or t.cost_firstownership_departmentname = '大客户经营中心本部')\\n        then '大客户经营中心(KA)' \\n       when (t.cost_firstownership_departmentcode='YN011' or t.cost_firstownership_departmentname = '地产行业中心本部')\\n        then '地产行业中心（RS）' \\n      when (t.cost_firstownership_departmentcode='YN025' or t.cost_firstownership_departmentname = '科技服务行业中心本部')\\n        then '科技服务行业中心（TS）' \\n       when (t.cost_firstownership_departmentcode='YN038.001' or t.cost_firstownership_departmentname = 'RPA产品中心')\\n        then 'RPA产品中心' \\n      when (t.cost_firstownership_departmentcode='YN009' or t.cost_firstownership_departmentname = '解决方案中心本部')\\n        then '解决方案中心' \\n      when (t.cost_firstownership_departmentcode='YN031.001' or t.cost_firstownership_departmentname = '预算产品中心')\\n        then '预算产品中心' \\n       when (t.cost_firstownership_departmentcode='YN035.001' or t.cost_firstownership_departmentname = '采购产品中心')\\n        then '采购产品中心' \\n       when (t.cost_firstownership_departmentcode='YN035.001' or t.cost_firstownership_departmentname = '采购产品中心')\\n        then '采购产品中心' \\n       when (t.cost_firstownership_departmentcode='YN010' or t.cost_firstownership_departmentname = '政府与公共事务中心本部')\\n        then '政府与公共事务中心' \\n       when (t.cost_firstownership_departmentcode='YN041.001' or t.cost_firstownership_departmentname = '物资主数据产品中心')\\n        then '物资主数据产品中心' \\n       when (t.cost_firstownership_departmentcode='YN029' or t.cost_firstownership_departmentname = '管理咨询中心')\\n        then '管理咨询中心本部' \\n      when (t.cost_firstownership_departmentcode='YN037.001' or t.cost_firstownership_departmentname = '商旅产品中心')\\n        then '商旅产品中心' \\n       when (t.cost_firstownership_departmentcode='YN034.001' or t.cost_firstownership_departmentname = '视觉设计部')\\n        then '视觉设计部' \\n        when (t.cost_firstownership_departmentcode='YN033.001' or t.cost_firstownership_departmentname = '方舟平台产品中心')\\n        then '方舟平台产品中心' \\n       when (t.cost_firstownership_departmentcode='YN039.001' or t.cost_firstownership_departmentname = '共享创新业务销售部')\\n        then '共享创新业务销售部' \\n       when (t.cost_firstownership_departmentcode='YN036.001' or t.cost_firstownership_departmentname = '税务产品中心')\\n        then '税务产品中心' \\n       when (t.cost_firstownership_departmentcode='YN028.001' or t.cost_firstownership_departmentname = '西南区销售部')\\n        then '西南区销售部' \\n       when (t.cost_firstownership_departmentcode='YN011.005' or t.cost_firstownership_departmentname = '地产行业发展部')\\n       then '地产研究院' \\n       when (t.cost_firstownership_departmentcode='YN043' or t.cost_firstownership_departmentname = '大客户事业五部（作废）')\\n       then '大客户事业五部' \\n      else t.cost_firstownership_departmentname\\n   end)  as org_name, --费用组织一级部门名称\\n  --t.cost_firstownership_departmentid,\\n\\t--t.cost_firstownership_departmentcode as cost_firstownership_departmentcode,\\n\\t--费用归属一级部门编码\\n  --t.cost_firstownership_departmentname,\\n\\t--费用归属一级部门名称\\n  --t.cost_secondownership_departmentid,\\n\\t--t.cost_secondownership_departmentcode as cost_secondownership_departmentcode,\\n\\t--费用归属二级部门编码\\n   --t.cost_secondownership_departmentname as cost_secondownership_departmentname,\\n     case \\n       when t.cost_ownership_name = '研发费用' then '研发费用.'\\n       else t.cost_ownership_name\\n   end as cost_s_leveltype_name,--费用归属二级名称\\n   case \\n       when t.cost_ownership_code = '研发费用' then '研发费用.'\\n       else t.cost_ownership_code\\n   end as cost_s_leveltype_code, --费用归属二级编码\\n\\ty.CODE as pay_f_level_code, --支出类型一级编码\\n   (case\\n        when (t.expenditure_type_code= 'DIM_EXP_SCGYBT_001')\\n           then '私车公用'\\n        when (t.expenditure_type_code= 'DIM_EXP_SCGY' and t.bill_code like 'FYBX%')\\n           then '私车公用'   \\n        when  (t.expenditure_type_code= 'DIM_EXP_WWFWF_001')\\n           then '外包服务费'\\n         when  (t.expenditure_type_code= 'DIM_EXP_CGWBFWFDSZF_001')\\n           then '外包服务费'   \\n        else y.NAME    \\n   end) as pay_f_level_name, --支出类型一级名称\\n\\tt.expenditure_type_code as pay_s_level_code, --支出类型二级编码\\n  (case\\n      when (t.bill_code like 'CLBX%' and  t.expenditure_type_code='DIM_EXP_SCGY')\\n        then concat(t.expenditure_type_name,'.')\\n      when (t.bill_code like 'CLBX%' and  t.expenditure_type_code='DIM_EXP_YC_001')\\n        then concat(t.expenditure_type_name,'.')\\n      when (t.bill_code like 'CLBX%' and  t.expenditure_type_code='DIM_EXP_EAT')\\n        then '交通类-交通费.'\\n       when (t.bill_code like 'FYBX%' and  t.expenditure_type_code='DIM_EXP_ZYLHYF_001')\\n        then '渠道-伙伴合作'\\n      when (t.expenditure_type_code = 'DIM_EXP_PPT_001' and  t.expenditure_type_name like '%调研报告%' )\\n         then '品牌-调用报告'\\n      when (t.expenditure_type_code = 'DIM_EXP_ZZZ_001' and t.expenditure_type_name='杂志-资料费')\\n         then '杂志-推广费'\\n      when (t.expenditure_type_code = 'DIM_EXP_ZZC_001' and t.expenditure_type_name='杂志-出刊费')\\n         then '杂志-发行费'\\n      when (t.expenditure_type_code = 'DIM_EXP_QTSK_001' and t.expenditure_type_name='品牌文化-其他书刊')\\n         then '品牌-活动费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_SKSF_001' and t.expenditure_type_name='品牌文化-书刊书费')\\n         then '品牌-活动费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_HD_001' and t.expenditure_type_name='品牌文化-其他活动')\\n         then '品牌-活动费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_HZZF_001' and t.expenditure_type_name='品牌文化-合作政府')\\n         then '品牌-活动费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_WLYXWZYWF_001' and  t.expenditure_type_name='品牌文化-网络营销网站运维费')\\n         then '品牌-平台费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_SKKWF_001' and t.expenditure_type_name='品牌文化-书刊刊物费')\\n         then '品牌-活动费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_HZJG_001' and t.expenditure_type_name='品牌文化-合作机构')\\n         then '品牌-活动费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_XCP_001' and t.expenditure_type_name='品牌文化-宣传品')\\n         then '品牌-营销物料'\\n      when (t.expenditure_type_code = 'DIM_EXP_QTHZ_001' and t.expenditure_type_name='品牌文化-其他合作')\\n         then '品牌-活动费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_HZCS_001' and t.expenditure_type_name='品牌文化-合作厂商')\\n         then '品牌-活动费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_SKZTF_001' and t.expenditure_type_name='品牌文化-书刊专题费')\\n         then '品牌-活动费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_QC' and t.expenditure_type_name='差旅类-汽车')\\n         then '交通类-交通费'\\n      when (t.expenditure_type_code = 'DIM_EXP_DDGRDF' and t.expenditure_type_name='差旅类-滴滴个人垫付')\\n         then '交通类-交通费'\\n      when (t.expenditure_type_code = 'DIM_EXP_DCF_002' and t.expenditure_type_name='交通类-其他交通')\\n         then '交通类-交通费'\\n      when (t.expenditure_type_code = 'DIM_EXP_KHHCP_001' and t.expenditure_type_name='交通类-客户火车票')\\n         then '交通类-交通费'\\n      when (t.expenditure_type_code = 'DIM_EXP_CTQCP_001' and t.expenditure_type_name='交通类-长途汽车票')\\n         then '交通类-交通费'\\n      when (t.expenditure_type_code = 'DIM_EXP_TCJGLGQF_001' and t.expenditure_type_name='交通类-停车及过路过桥费')\\n         then '交通类-交通费'\\n      when (t.expenditure_type_code = 'DIM_EXP_QYZCF_001' and t.expenditure_type_name='交通类-企业租车费')\\n         then '交通类-交通费'\\n      when (t.expenditure_type_code = 'DIM_EXP_JYF_001' and t.expenditure_type_name='交通类-加油费')\\n         then '交通类-交通费'\\n      when (t.expenditure_type_code = 'DIM_EXP_KHJP_001' and t.expenditure_type_name like '%客户机票%')\\n         then '餐饮类-客户招待'\\n      when (t.expenditure_type_code = 'DIM_EXP_KHLC_001' and t.expenditure_type_name='客户轮船')\\n         then '餐饮类-客户招待'\\n      when (t.expenditure_type_code = 'DIM_EXP_YF_001' and t.expenditure_type_name='行政-装修')\\n         then '行政-办公室维护'\\n      when (t.expenditure_type_code = 'DIM_EXP_GSNH_001' and t.expenditure_type_name='行政-公司年会')\\n         then '公共费用-福利费'\\n      when (t.expenditure_type_code = 'DIM_EXP_TJCF_001' and t.expenditure_type_name='餐饮类-团建餐费')\\n         then '公共费用-部门（团队）建设费'\\n      when (t.expenditure_type_code = 'DIM_EXP_WF_001' and t.expenditure_type_name='网费')\\n         then '办公-办公用品'\\n      when (t.expenditure_type_code = 'DIM_EXP_SJDHF_001' and t.expenditure_type_name='手机电话费')\\n         then '办公-办公用品'\\n      when (t.expenditure_type_code = 'DIM_EXP_YJF_001' and t.expenditure_type_name='邮寄费')\\n         then '办公-办公用品'\\n      when (t.expenditure_type_code = 'DIM_EXP_DYFYZD_001' and t.expenditure_type_name='打印复印装订')\\n         then '办公-办公用品'\\n      when (t.expenditure_type_code = 'DIM_EXP_QTBGXGFY_001' and t.expenditure_type_name='办公礼品类-其他办公相关费用')\\n         then '办公-办公用品'\\n      when (t.expenditure_type_code = 'DIM_EXP_DZYH_001' and t.expenditure_type_name='办公礼品类-快递费')\\n         then '办公-办公用品'\\n      when (t.expenditure_type_code = 'DIM_EXP_LPF_001' and t.expenditure_type_name='礼品费')\\n         then '办公-礼品费'\\n      when (t.expenditure_type_code = 'DIM_EXP_SJF_001' and t.expenditure_type_name='采购-图书')\\n         then '办公-办公用品'\\n      when (t.expenditure_type_code = 'DIM_EXP_CGY_001' and t.expenditure_type_name='采购-佣金费')\\n         then '渠道-佣金费'\\n      when (t.expenditure_type_code = 'DIM_EXP_RQF_001' and t.expenditure_type_name='燃气费')\\n         then '租房相关-项目组租房相关费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_LHF_001' and t.expenditure_type_name='绿化费')\\n         then '行政-办公室维护'\\n      when (t.expenditure_type_code = 'DIM_EXP_NQF_001' and t.expenditure_type_name='租房相关-暖气费')\\n         then '租房相关-项目组租房相关费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_SDF_001' and t.expenditure_type_name='租房相关-水电费')\\n         then '租房相关-项目组租房相关费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_BAF_001' and t.expenditure_type_name='租房相关-宽带费')\\n         then '租房相关-项目组租房相关费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_WYF_001' and t.expenditure_type_name='租房相关-物业费')\\n         then '租房相关-项目组租房相关费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_BJF_001' and t.expenditure_type_name='租房相关-床上用品')\\n         then '公共费用-福利费'\\n      when (t.expenditure_type_code = 'DIM_EXP_TXF_001' and t.expenditure_type_name= '公共费用-通讯费')\\n         then '办公-办公用品'\\n      when (t.expenditure_type_code = 'DIM_EXP_JHSYFL_001' and t.expenditure_type_name='公共费用-结婚生育福利')\\n         then '公共费用-福利费'\\n      when (t.expenditure_type_code = 'DIM_EXP_LPFY_001' and t.expenditure_type_name='礼品费')\\n         then '办公-礼品费'\\n      when (t.expenditure_type_code = 'DIM_EXP_XMHDF_001' and t.expenditure_type_name='公共费用-项目活动费')\\n         then '公共费用-福利费'\\n      when (t.expenditure_type_code = 'DIM_EXP_SJF_002' and t.expenditure_type_name='财务-审计费')\\n         then '财务-鉴证咨询'\\n      when (t.expenditure_type_code = 'DIM_EXP_YZF_001' and t.expenditure_type_name='财务-验资费')\\n         then '财务-鉴证咨询'\\n      when (t.expenditure_type_code = 'DIM_EXP_CB_001' and t.expenditure_type_name='云流量-成本')\\n         then '元年云-服务器运营成本'\\n      when (t.expenditure_type_code = 'DIM_EXP_KHZS_001' and t.expenditure_type_name='住宿类-客户住宿')\\n         then '餐饮类-客户招待'\\n    else t.expenditure_type_name\\n  end \\n  ) as pay_s_level_name--支出类型二级名称\\nfrom\\n\\tdwd_fact_cost_control_detail t\\nleft join dwd_dim_cost_pay_type y on\\n\\t(t.expenditure_type_parent_id = y.OBJECT_ID)\\nwhere t.cost_firstownership_departmentid is not null or t.cost_firstownership_departmentid !=''\",\"tableInfo\":[{\"tableName\":\"dwd_dim_cost_pay_type\",\"lane\":\"27786ca8-f569-49c8-864a-f5f3b04cabd4\",\"isActive\":true},{\"tableName\":\"dwd_fact_cost_control_detail\",\"lane\":\"55331083-3122-4ccf-a7c9-c62bd9e31f2b\",\"isActive\":false}]},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"费用归属一级\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.sql.SparkSqlScriptProcessor\",\"input_point_ids\":[\"4b66299f-8882-4b1f-9050-d96fdf78096d\"],\"out_point_ids\":[\"076c5140-d61b-42d9-a701-127e15f76d59\"],\"inputLanes\":[\"27786ca8-f569-49c8-864a-f5f3b04cabd4\",\"55331083-3122-4ccf-a7c9-c62bd9e31f2b\"],\"outputLanes\":[\"076c5140-d61b-42d9-a701-127e15f76d59\"]}},\"zIndex\":13,\"mouseleave\":1664524396426,\"mousedown\":1660632949486,\"mousemove\":1660632950509,\"mouseup\":1660632950836,\"ports\":{\"groups\":{\"in\":{\"position\":\"left\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"connectionCount\":1,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}},\"out\":{\"position\":\"right\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}}},\"items\":[{\"group\":\"in\",\"id\":\"4b66299f-8882-4b1f-9050-d96fdf78096d\",\"connected\":true},{\"group\":\"out\",\"id\":\"076c5140-d61b-42d9-a701-127e15f76d59\"},{\"group\":\"in\",\"id\":\"4bd3457d-bd24-4a34-8d1e-3b5a8223c8e6\",\"connected\":true}]}},{\"position\":{\"x\":356.7861328125,\"y\":90},\"size\":{\"width\":135,\"height\":40},\"view\":\"vue-shape-view\",\"shape\":\"vue-shape\",\"id\":\"950c8924-5551-40a4-86b3-bf9197b27fb8\",\"component\":\"dropdown-component-SQL_SCRIPT\",\"data\":{\"stages\":{\"dagId\":\"11ed0bf19650e159928e7b7d5ec54760\",\"stageId\":\"950c8924-5551-40a4-86b3-bf9197b27fb8\",\"checkPassed\":true,\"componentType\":\"PROCESS\",\"configPageCode\":\"SQL_SCRIPT\",\"configPageCodeName\":\"SQL_SCRIPT\",\"configuration\":{\"sqlScript\":\"(\\n  select * \\n  from table1 t1\\n  where t1.org_code not in('YN005.011','YN006.006.010','YN006.014','YN101.29')\\n   and t1.project_code not in('O2019114280','O2019104234','O2018121344','O2018120502','O2019032564','O2018120487','O2019104259',\\n                             'MK20220009','MK20210001')\\n)\\nunion all\\n(\\n  select *\\n  from table2 t2\\n  where t2.org_code not in('YN005.011','YN006.006.010','YN006.014','YN101.29')  \\n   and t2.project_code not in('O2019114280','O2019104234','O2018121344','O2018120502','O2019032564','O2018120487','O2019104259',\\n                             'MK20220009','MK20210001')\\n)\\n                  \",\"tableInfo\":[{\"tableName\":\"table1\",\"lane\":\"0ea45c70-723e-49c7-88dd-28ed9d179883\",\"isActive\":true},{\"tableName\":\"table2\",\"lane\":\"076c5140-d61b-42d9-a701-127e15f76d59\",\"isActive\":false}]},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"费用归属合并\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.sql.SparkSqlScriptProcessor\",\"input_point_ids\":[\"62435bf7-d60c-4fc3-9f01-529060524fc2\"],\"out_point_ids\":[\"bbca9d22-5f11-4ba9-916f-91fbb9b2a98f\"],\"inputLanes\":[\"0ea45c70-723e-49c7-88dd-28ed9d179883\",\"076c5140-d61b-42d9-a701-127e15f76d59\"],\"outputLanes\":[\"bbca9d22-5f11-4ba9-916f-91fbb9b2a98f\"]}},\"zIndex\":14,\"mouseleave\":1664524535955,\"mousedown\":1660632992614,\"mousemove\":1660632992844,\"mouseup\":1660632993372,\"doubleClick\":1660632979658,\"ports\":{\"groups\":{\"in\":{\"position\":\"left\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"connectionCount\":1,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}},\"out\":{\"position\":\"right\",\"attrs\":{\"circle\":{\"r\":3,\"magnet\":true,\"stroke\":\"#999999\",\"strokeWidth\":1,\"fill\":\"#666666\"}}}},\"items\":[{\"group\":\"out\",\"id\":\"bbca9d22-5f11-4ba9-916f-91fbb9b2a98f\"},{\"group\":\"in\",\"id\":\"6a881a41-31cf-464d-9bf3-9d2882e73bdf\",\"connected\":true},{\"group\":\"in\",\"id\":\"57948312-01df-4697-89cd-1ad56cc8dd67\",\"connected\":true}]}}]}",
            "createBy": "11ec0008a7d6e713ac562bef87a44fb9",
            "updateBy": "11ec0008a7d6e713ac562bef87a44fb9",
            "dagJson": "{\"enableHive\":true,\"logLevel\":\"INFO\",\"stages\":[{\"dagId\":\"11ed0bf19650e159928e7b7d5ec54760\",\"stageId\":\"b38342eb-cf6c-4c11-9166-640c1a626e52\",\"checkPassed\":true,\"componentType\":\"SOURCE\",\"configPageCode\":\"TABLE_INPUT\",\"configPageCodeName\":\"TABLE_INPUT\",\"configuration\":{\"query\":\"select * from \\\"dwd\\\".\\\"dwd_fact_cost_control_detail\\\"\",\"name\":\"表输入_费控分摊明细表\",\"queryTimeout\":7200,\"isOutPuts\":false,\"datasourceName\":\"工时数仓(gp)\",\"schemaName\":\"dwd\",\"tableName\":\"dwd_fact_cost_control_detail\",\"businessSystemId\":\"1e6cb02b462345eba15f734b723457c6\",\"datasourceType\":\"Greenplum\",\"datasourceId\":\"12386e4567d922eba15f612c11ddae17\",\"schemaId\":\"11ecfccdb77d7376a31ffbd550285939\",\"tableId\":\"11ed01bec95ccee4a31fd5fd1a67cc91\",\"dataBaseType\":null,\"driver\":\"com.pivotal.jdbc.GreenplumDriver\",\"url\":\"jdbc:postgresql://192.168.58.27:5432/yuannian?gssEncMode=disable\",\"user\":\"gpadmin\",\"password\":\"P5YtcBDeK8k0Q33vULNr/8d1P+VDNdQ5Tljk371VoP4=\",\"dbtable\":\"dwd_fact_cost_control_detail\",\"dbtableId\":\"11ed01bec95ccee4a31fd5fd1a67cc91\"},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"表输入_费控分摊明细表\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.jdbc.greenplum.GreenplumSource\",\"input_point_ids\":[],\"out_point_ids\":[\"55331083-3122-4ccf-a7c9-c62bd9e31f2b\"],\"inputLanes\":[],\"outputLanes\":[\"55331083-3122-4ccf-a7c9-c62bd9e31f2b\"]},{\"dagId\":\"11ed0bf19650e159928e7b7d5ec54760\",\"stageId\":\"b5828548-0b4d-4060-b54b-d2f4e97af87b\",\"checkPassed\":true,\"componentType\":\"SOURCE\",\"configPageCode\":\"TABLE_INPUT\",\"configPageCodeName\":\"TABLE_INPUT\",\"configuration\":{\"query\":\"select * from \\\"dwd\\\".\\\"dwd_dim_cost_pay_type\\\"\",\"name\":\"表输入_支出类型\",\"queryTimeout\":7200,\"isOutPuts\":false,\"datasourceName\":\"工时数仓(gp)\",\"schemaName\":\"dwd\",\"tableName\":\"dwd_dim_cost_pay_type\",\"businessSystemId\":\"1e6cb02b462345eba15f734b723457c6\",\"datasourceType\":\"Greenplum\",\"datasourceId\":\"12386e4567d922eba15f612c11ddae17\",\"schemaId\":\"11ecfccdb77d7376a31ffbd550285939\",\"tableId\":\"11ed06442fe25c9ca31fdff60183c513\",\"dataBaseType\":null,\"driver\":\"com.pivotal.jdbc.GreenplumDriver\",\"url\":\"jdbc:postgresql://192.168.58.27:5432/yuannian?gssEncMode=disable\",\"user\":\"gpadmin\",\"password\":\"P5YtcBDeK8k0Q33vULNr/8d1P+VDNdQ5Tljk371VoP4=\",\"dbtable\":\"dwd_dim_cost_pay_type\",\"dbtableId\":\"11ed06442fe25c9ca31fdff60183c513\"},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"表输入_支出类型\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.jdbc.greenplum.GreenplumSource\",\"input_point_ids\":[],\"out_point_ids\":[\"27786ca8-f569-49c8-864a-f5f3b04cabd4\"],\"inputLanes\":[],\"outputLanes\":[\"27786ca8-f569-49c8-864a-f5f3b04cabd4\"]},{\"dagId\":\"11ed0bf19650e159928e7b7d5ec54760\",\"stageId\":\"65bea34e-286c-4e76-9926-5d32d82ff32c\",\"checkPassed\":true,\"componentType\":\"SOURCE\",\"configPageCode\":\"TABLE_INPUT\",\"configPageCodeName\":\"TABLE_INPUT\",\"configuration\":{\"query\":\"select * from \\\"dwd\\\".\\\"dwd_dim_cost_expense_type\\\"\",\"name\":\"表输入_费用归属\",\"queryTimeout\":7200,\"isOutPuts\":false,\"datasourceName\":\"工时数仓(gp)\",\"schemaName\":\"dwd\",\"tableName\":\"dwd_dim_cost_expense_type\",\"businessSystemId\":\"1e6cb02b462345eba15f734b723457c6\",\"datasourceType\":\"Greenplum\",\"datasourceId\":\"12386e4567d922eba15f612c11ddae17\",\"schemaId\":\"11ecfccdb77d7376a31ffbd550285939\",\"tableId\":\"11ed03e9679ed91fa31f15ab693d4d83\",\"dataBaseType\":null,\"driver\":\"com.pivotal.jdbc.GreenplumDriver\",\"url\":\"jdbc:postgresql://192.168.58.27:5432/yuannian?gssEncMode=disable\",\"user\":\"gpadmin\",\"password\":\"P5YtcBDeK8k0Q33vULNr/8d1P+VDNdQ5Tljk371VoP4=\",\"dbtable\":\"dwd_dim_cost_expense_type\",\"dbtableId\":\"11ed03e9679ed91fa31f15ab693d4d83\"},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"表输入_费用归属\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.jdbc.greenplum.GreenplumSource\",\"input_point_ids\":[],\"out_point_ids\":[\"ae9d9209-f647-4564-a425-d06a715f245c\"],\"inputLanes\":[],\"outputLanes\":[\"ae9d9209-f647-4564-a425-d06a715f245c\"]},{\"dagId\":\"11ed0bf19650e159928e7b7d5ec54760\",\"stageId\":\"0c05d367-1e9e-4ebd-9d33-5384fb927d86\",\"checkPassed\":true,\"componentType\":\"PROCESS\",\"configPageCode\":\"SQL_SCRIPT\",\"configPageCodeName\":\"SQL_SCRIPT\",\"configuration\":{\"sqlScript\":\"select\\n  t.*, \\n  y.partent_name as cost_f_leveltype_name, --一级费用类型名称\\n  y.partent_code as cost_f_leveltype_code -- 一级费用类型编码\\nfrom dws_cost_department_pay_type t \\nleft join dwd_dim_cost_expense_type y \\non (t.cost_ownership_id = y.OBJECT_ID)\",\"tableInfo\":[{\"tableName\":\"dws_cost_department_pay_type\",\"lane\":\"7ec706f0-ea90-472f-a463-611a68c7f157\",\"isActive\":true},{\"tableName\":\"dwd_dim_cost_expense_type\",\"lane\":\"ae9d9209-f647-4564-a425-d06a715f245c\",\"isActive\":false}]},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"SQL组件费用归属\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.sql.SparkSqlScriptProcessor\",\"input_point_ids\":[\"f80a818c-1167-4efc-98ca-ecc0ba9ad968\"],\"out_point_ids\":[\"5d098830-25be-4dbe-abc1-783edbc3d84e\"],\"inputLanes\":[\"7ec706f0-ea90-472f-a463-611a68c7f157\",\"ae9d9209-f647-4564-a425-d06a715f245c\"],\"outputLanes\":[\"5d098830-25be-4dbe-abc1-783edbc3d84e\"]},{\"dagId\":\"11ed0bf19650e159928e7b7d5ec54760\",\"stageId\":\"684080cc-be17-4f73-92bb-348c3b04bb2f\",\"checkPassed\":true,\"componentType\":\"PROCESS\",\"configPageCode\":\"SQL_SCRIPT\",\"configPageCodeName\":\"SQL_SCRIPT\",\"configuration\":{\"sqlScript\":\"select \\n  share_year,\\n  share_month, \\n  org_code,\\n  org_name,\\n  cost_f_leveltype_code,\\n  cost_f_leveltype_name,\\n  cost_s_leveltype_code,\\n  cost_s_leveltype_name,\\n  pay_f_level_code,\\n  pay_f_level_name,\\n  pay_s_level_code,\\n  pay_s_level_name,\\n  sum(document_quantity) document_quantity\\nfrom \\n(\\n  select\\n    share_year as share_year, --年\\n    share_month as share_month, --期间\\n    org_code,\\n    org_name,\\n    cost_f_leveltype_code as cost_f_leveltype_code, --费用归属类型一级编码\\n    cost_f_leveltype_name as cost_f_leveltype_name, --费用归属类型一级名称\\n    cost_s_leveltype_code as cost_s_leveltype_code, --费用归属类型二级编码\\n    cost_s_leveltype_name as cost_s_leveltype_name, --费用归属类型二级名称\\n    pay_f_level_code as pay_f_level_code, --支出类型一级编码\\n    pay_f_level_name as pay_f_level_name, --支出类型一级名称\\n    pay_s_level_code as pay_s_level_code, --支出类型二级编码\\n    pay_s_level_name as pay_s_level_name, --支出类型二级名称\\n    count(distinct bill_code) as document_quantity --单据量\\n  from dws_cost_department_pay_type\\n  group by \\n  share_year,\\n  share_month, \\n  project_code, \\n  project_description,\\n  org_code,\\n  org_name,\\n  cost_f_leveltype_code,\\n  cost_f_leveltype_name,\\n  cost_s_leveltype_code,\\n  cost_s_leveltype_name,\\n  pay_f_level_code,\\n  pay_f_level_name,\\n  pay_s_level_code,\\n  pay_s_level_name \\n) t1\\n  group by \\n  share_year,\\n  share_month, \\n  org_code,\\n  org_name,\\n  cost_f_leveltype_code,\\n  cost_f_leveltype_name,\\n  cost_s_leveltype_code,\\n  cost_s_leveltype_name,\\n  pay_f_level_code,\\n  pay_f_level_name,\\n  pay_s_level_code,\\n  pay_s_level_name \",\"tableInfo\":[{\"tableName\":\"dws_cost_department_pay_type\",\"lane\":\"5d098830-25be-4dbe-abc1-783edbc3d84e\",\"isActive\":true}]},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"SQL组件单据量\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.sql.SparkSqlScriptProcessor\",\"input_point_ids\":[\"1f3170cb-d2ae-4837-a24d-815a74f671c6\"],\"out_point_ids\":[\"8799990c-6827-45fd-8329-e56f39f31c33\"],\"inputLanes\":[\"5d098830-25be-4dbe-abc1-783edbc3d84e\"],\"outputLanes\":[\"8799990c-6827-45fd-8329-e56f39f31c33\"]},{\"dagId\":\"11ed0bf19650e159928e7b7d5ec54760\",\"stageId\":\"e67b9333-6f45-4807-8d3d-814b291d6918\",\"checkPassed\":true,\"componentType\":\"SINK\",\"configPageCode\":\"TABLE_OUTPUT\",\"configPageCodeName\":\"TABLE_OUTPUT\",\"configuration\":{\"name\":\"表输出_部门项目支出类型信息明细表\",\"model\":\"overwrite\",\"isOutPuts\":false,\"datasourceName\":\"工时数仓(gp)\",\"schemaName\":\"dws\",\"tableName\":\"dws_cost_department_pay_type\",\"businessSystemId\":\"1e6cb02b462345eba15f734b723457c6\",\"datasourceType\":\"Greenplum\",\"datasourceId\":\"12386e4567d922eba15f612c11ddae17\",\"schemaId\":\"11ecfccf827f1933a31f1d3be54d445b\",\"tableId\":\"11ed0cb0da5d7abba31f813afcfe46e9\",\"dataBaseType\":null,\"driver\":\"com.pivotal.jdbc.GreenplumDriver\",\"dbtable\":\"\\\"dws\\\".\\\"dws_cost_department_pay_type\\\"\",\"url\":\"jdbc:postgresql://192.168.58.27:5432/yuannian?gssEncMode=disable\",\"user\":\"gpadmin\",\"password\":\"P5YtcBDeK8k0Q33vULNr/8d1P+VDNdQ5Tljk371VoP4=\",\"dbtableId\":\"11ed0cb0da5d7abba31f813afcfe46e9\"},\"maxInputPoint\":1,\"maxOutputPoint\":0,\"name\":\"表输出_部门项目支出类型信息明细表\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.jdbc.greenplum.GreenplumTarget\",\"input_point_ids\":[\"c3ff45f4-8a85-4506-b086-dd74c771c11f\"],\"out_point_ids\":[],\"inputLanes\":[\"8799990c-6827-45fd-8329-e56f39f31c33\"],\"outputLanes\":[]},{\"dagId\":\"11ed0bf19650e159928e7b7d5ec54760\",\"stageId\":\"668762a4-9769-44df-8d76-596668e03878\",\"checkPassed\":true,\"componentType\":\"PROCESS\",\"configPageCode\":\"SQL_SCRIPT\",\"configPageCodeName\":\"SQL_SCRIPT\",\"configuration\":{\"sqlScript\":\"select detail.*\\nfrom t_cost_detail detail \\nleft join t_center org \\non org_id = org.department_id\\nwhere org.department_is_leaf = 'TRUE'\",\"tableInfo\":[{\"tableName\":\"t_cost_detail\",\"lane\":\"831c240f-6fc9-491b-89c3-085f6aa41251\",\"isActive\":true},{\"tableName\":\"t_center\",\"lane\":\"74905d03-2c25-4d11-85ec-54c18670c72c\",\"isActive\":false}]},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"清洗末级部门\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.sql.SparkSqlScriptProcessor\",\"input_point_ids\":[\"bacc32f6-3235-45b7-a88a-88eaba0ca09d\"],\"out_point_ids\":[\"7ec706f0-ea90-472f-a463-611a68c7f157\"],\"inputLanes\":[\"831c240f-6fc9-491b-89c3-085f6aa41251\",\"74905d03-2c25-4d11-85ec-54c18670c72c\"],\"outputLanes\":[\"7ec706f0-ea90-472f-a463-611a68c7f157\"]},{\"dagId\":\"11ed0bf19650e159928e7b7d5ec54760\",\"stageId\":\"396b221e-fcb3-4421-8ae2-293ef591bf66\",\"checkPassed\":true,\"componentType\":\"SOURCE\",\"configPageCode\":\"TABLE_INPUT\",\"configPageCodeName\":\"TABLE_INPUT\",\"configuration\":{\"query\":\"select * from \\\"dwd\\\".\\\"dwd_dim_cost_department_center\\\"\",\"name\":\"表输入_责任中心\",\"queryTimeout\":7200,\"isOutPuts\":false,\"datasourceName\":\"工时数仓(gp)\",\"schemaName\":\"dwd\",\"tableName\":\"dwd_dim_cost_department_center\",\"businessSystemId\":\"1e6cb02b462345eba15f734b723457c6\",\"datasourceType\":\"Greenplum\",\"datasourceId\":\"12386e4567d922eba15f612c11ddae17\",\"schemaId\":\"11ecfccdb77d7376a31ffbd550285939\",\"tableId\":\"11ed03e9679ed91ea31f77625aa005fb\",\"dataBaseType\":null,\"driver\":\"com.pivotal.jdbc.GreenplumDriver\",\"url\":\"jdbc:postgresql://192.168.58.27:5432/yuannian?gssEncMode=disable\",\"user\":\"gpadmin\",\"password\":\"P5YtcBDeK8k0Q33vULNr/8d1P+VDNdQ5Tljk371VoP4=\",\"dbtable\":\"dwd_dim_cost_department_center\",\"dbtableId\":\"11ed03e9679ed91ea31f77625aa005fb\"},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"表输入_责任中心\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.jdbc.greenplum.GreenplumSource\",\"input_point_ids\":[],\"out_point_ids\":[\"74905d03-2c25-4d11-85ec-54c18670c72c\"],\"inputLanes\":[],\"outputLanes\":[\"74905d03-2c25-4d11-85ec-54c18670c72c\"]},{\"dagId\":\"11ed0bf19650e159928e7b7d5ec54760\",\"stageId\":\"00574896-9086-475c-aa37-961245331607\",\"checkPassed\":true,\"componentType\":\"PROCESS\",\"configPageCode\":\"SQL_SCRIPT\",\"configPageCodeName\":\"SQL_SCRIPT\",\"configuration\":{\"sqlScript\":\"select \\n  bill_code,\\n  cost_ownership_id,\\n  share_year,\\n  share_month,\\n  project_code, \\n  project_description,\\n  org_id,\\n  org_code,\\n  org_name,\\n  --cost_firstownership_departmentid,\\n  --cost_firstownership_departmentcode,\\n  --cost_firstownership_departmentname,\\n  --cost_secondownership_departmentid,\\n  --cost_secondownership_departmentcode,\\n  --cost_secondownership_departmentname,\\n  cost_s_leveltype_code,\\n  cost_s_leveltype_name,\\n  pay_f_level_code,\\n  (case\\n    when(pay_s_level_name = '交通类-交通费')\\n        then '交通类'\\n    when(pay_s_level_name = '餐饮类-客户招待')\\n        then '餐饮类'\\n    when(pay_s_level_name = '公共费用-福利费')\\n        then '公共费用'\\n    when(pay_s_level_name = '公共费用-部门（团队）建设费')\\n        then '公共费用'\\n    when(pay_s_level_name = '采购-外包服务费（对公支付）')\\n        then '外包服务费'\\n    when(pay_s_level_name = '采购-外包服务费（对私支付）')\\n        then '外包服务费'\\n    when(pay_s_level_name = '办公-办公用品')\\n        then '办公礼品类' \\n    when(pay_s_level_name = '渠道-佣金费')\\n        then '渠道类'\\n    when(pay_s_level_name = '公共费用-福利费')\\n        then '公共费用'\\n    when(pay_s_level_name = '办公-礼品费')\\n        then '办公礼品类'\\n    else\\n        pay_f_level_name\\n  end) as pay_f_level_name,\\n  pay_s_level_code,\\n  pay_s_level_name\\nfrom t_detail\",\"tableInfo\":[{\"tableName\":\"t_detail\",\"lane\":\"bbca9d22-5f11-4ba9-916f-91fbb9b2a98f\",\"isActive\":true}]},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"清洗支出类型一级\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.sql.SparkSqlScriptProcessor\",\"input_point_ids\":[\"a93bb905-9e10-4bbf-8d13-f1dc45efdb97\"],\"out_point_ids\":[\"831c240f-6fc9-491b-89c3-085f6aa41251\"],\"inputLanes\":[\"bbca9d22-5f11-4ba9-916f-91fbb9b2a98f\"],\"outputLanes\":[\"831c240f-6fc9-491b-89c3-085f6aa41251\"]},{\"dagId\":\"11ed0bf19650e159928e7b7d5ec54760\",\"stageId\":\"197b2446-f7cb-425c-8432-1eb1f9dd4a50\",\"checkPassed\":true,\"componentType\":\"PROCESS\",\"configPageCode\":\"SQL_SCRIPT\",\"configPageCodeName\":\"SQL_SCRIPT\",\"configuration\":{\"sqlScript\":\"select\\n\\tt.bill_code ,\\n  t.cost_ownership_id, --费用归属父级ID因业务改动，先只需用二级的ID去关联\\n  t.project_code, \\n  t.project_description,\\n\\tt.business_year as share_year,\\n\\t--年\\n\\tt.business_month as share_month,\\n\\t--期间\\n  t.cost_secondownership_departmentid org_id,\\n  t.cost_secondownership_departmentcode org_code,\\n  -- 因dm模型没有该组织名，所以目前根据code进行清洗成匹配目前的开发环境。在生产环境中可能进行修改\\n   (case \\n    when (t.cost_secondownership_departmentcode='YN001' or t.cost_secondownership_departmentname='综合中心本部')\\n        then '管理团队'\\n      when (t.cost_secondownership_departmentcode='YN026' or t.cost_secondownership_departmentname = '大客户经营二中心本部')\\n        then '大客户经营二中心' \\n      when (t.cost_secondownership_departmentcode='YN003' or t.cost_secondownership_departmentname = '品牌营销中心本部')\\n        then '品牌营销中心'   \\n      when (t.cost_secondownership_departmentcode='YN006' or t.cost_secondownership_departmentname = '研发中心本部')\\n        then '研发中心'\\n      when (t.cost_secondownership_departmentcode='YN016' or t.cost_secondownership_departmentname = '银行行业中心本部')\\n        then '银行行业中心（BK）' \\n      when (t.cost_secondownership_departmentcode='YN024' or t.cost_secondownership_departmentname = '零售快消行业中心本部')\\n        then '零售快消行业中心（RF）' \\n        when (t.cost_secondownership_departmentcode='YN034' or t.cost_secondownership_departmentname = '视觉设计部')\\n        then '视觉设计部' \\n      when (t.cost_secondownership_departmentcode='YN012' or t.cost_secondownership_departmentname = '金融行业中心本部')\\n        then '金融行业中心（FC）' \\n       when (t.cost_secondownership_departmentcode='YN022' or t.cost_secondownership_departmentname = '能源化工行业中心本部')\\n        then '能源化工行业中心（EC）' \\n      when (t.cost_secondownership_departmentcode='YN023' or t.cost_secondownership_departmentname = '装备制造行业中心本部')\\n        then '装备制造行业中心（EM）' \\n       when (t.cost_secondownership_departmentcode='YN011.001' or t.cost_secondownership_departmentname = 'RS华东事业部')\\n        then 'RS华东交付一部' \\n       when (t.cost_secondownership_departmentcode='YN011.002' or t.cost_secondownership_departmentname = 'RS华南事业部')\\n        then 'RS华南交付部' \\n        when (t.cost_secondownership_departmentcode='YN011.004' or t.cost_secondownership_departmentname = 'RS华北事业部')\\n        then 'RS华北交付一部' \\n       when (t.cost_secondownership_departmentcode='YN032.001' or t.cost_secondownership_departmentname = '财务共享产品中心')\\n        then '财务共享产品中心' \\n       when (t.cost_secondownership_departmentcode='YN027.001' or t.cost_secondownership_departmentname = '央企销售部')\\n        then '央企销售部' \\n        when (t.cost_secondownership_departmentcode='YN013' or t.cost_secondownership_departmentname = '大客户经营中心本部')\\n        then '大客户经营中心(KA)' \\n       when (t.cost_secondownership_departmentcode='YN011' or t.cost_secondownership_departmentname = '地产行业中心本部')\\n        then '地产行业中心（RS）' \\n      when (t.cost_secondownership_departmentcode='YN025' or t.cost_secondownership_departmentname = '科技服务行业中心本部')\\n        then '科技服务行业中心（TS）' \\n       when (t.cost_secondownership_departmentcode='YN038.001' or t.cost_secondownership_departmentname = 'RPA产品中心')\\n        then 'RPA产品中心' \\n      when (t.cost_secondownership_departmentcode='YN009' or t.cost_secondownership_departmentname = '解决方案中心本部')\\n        then '解决方案中心' \\n      when (t.cost_secondownership_departmentcode='YN031.001' or t.cost_secondownership_departmentname = '预算产品中心')\\n        then '预算产品中心' \\n       when (t.cost_secondownership_departmentcode='YN035.001' or t.cost_secondownership_departmentname = '采购产品中心')\\n        then '采购产品中心' \\n       when (t.cost_secondownership_departmentcode='YN035.001' or t.cost_secondownership_departmentname = '采购产品中心')\\n        then '采购产品中心' \\n       when (t.cost_secondownership_departmentcode='YN010' or t.cost_secondownership_departmentname = '政府与公共事务中心本部')\\n        then '政府与公共事务中心' \\n       when (t.cost_secondownership_departmentcode='YN041.001' or t.cost_secondownership_departmentname = '物资主数据产品中心')\\n        then '物资主数据产品中心' \\n       when (t.cost_secondownership_departmentcode='YN029' or t.cost_secondownership_departmentname = '管理咨询中心')\\n        then '管理咨询中心本部' \\n      when (t.cost_secondownership_departmentcode='YN037.001' or t.cost_secondownership_departmentname = '商旅产品中心')\\n        then '商旅产品中心' \\n       when (t.cost_secondownership_departmentcode='YN034.001' or t.cost_secondownership_departmentname = '视觉设计部')\\n        then '视觉设计部' \\n        when (t.cost_secondownership_departmentcode='YN033.001' or t.cost_secondownership_departmentname = '方舟平台产品中心')\\n        then '方舟平台产品中心' \\n       when (t.cost_secondownership_departmentcode='YN039.001' or t.cost_secondownership_departmentname = '共享创新业务销售部')\\n        then '共享创新业务销售部' \\n       when (t.cost_secondownership_departmentcode='YN036.001' or t.cost_secondownership_departmentname = '税务产品中心')\\n        then '税务产品中心' \\n       when (t.cost_secondownership_departmentcode='YN028.001' or t.cost_secondownership_departmentname = '西南区销售部')\\n        then '西南区销售部' \\n       when (t.cost_secondownership_departmentcode='YN011.005' or t.cost_secondownership_departmentname = '地产行业发展部')\\n       then '地产研究院' \\n       when (t.cost_secondownership_departmentcode='YN043' or t.cost_secondownership_departmentname = '大客户事业五部（作废）')\\n       then '大客户事业五部' \\n      else t.cost_secondownership_departmentname\\n   end) as org_name, --费用组织二级部门名称\\n  --t.cost_firstownership_departmentid,\\n\\t--t.cost_firstownership_departmentcode as cost_firstownership_departmentcode,\\n\\t--费用归属一级部门编码\\n  --t.cost_firstownership_departmentname,\\n\\t--费用归属一级部门名称\\n  --t.cost_secondownership_departmentid,\\n\\t--t.cost_secondownership_departmentcode as cost_secondownership_departmentcode,\\n\\t--费用归属二级部门编码\\n  --t.cost_secondownership_departmentname as cost_secondownership_departmentname,\\n     case \\n       when t.cost_ownership_name = '研发费用' then '研发费用.'\\n       else t.cost_ownership_name\\n   end as cost_s_leveltype_name,--费用归属二级名称\\n   case \\n       when t.cost_ownership_code = '研发费用' then '研发费用.'\\n       else t.cost_ownership_code\\n   end as cost_s_leveltype_code, --费用归属二级编码\\n\\t--费用归属类型二级名称\\n\\ty.CODE as pay_f_level_code, --支出类型一级编码\\n   (case\\n        when (t.expenditure_type_code= 'DIM_EXP_SCGYBT_001')\\n           then '私车公用'\\n        when (t.expenditure_type_code= 'DIM_EXP_SCGY' and t.bill_code like 'FYBX%')\\n           then '私车公用'   \\n        when  (t.expenditure_type_code= 'DIM_EXP_WWFWF_001')\\n           then '外包服务费'\\n         when  (t.expenditure_type_code= 'DIM_EXP_CGWBFWFDSZF_001')\\n           then '外包服务费'   \\n        else y.NAME    \\n   end) as pay_f_level_name, --支出类型一级名称\\n\\tt.expenditure_type_code as pay_s_level_code, --支出类型二级编码\\n  (case\\n      when (t.bill_code like 'CLBX%' and  t.expenditure_type_code='DIM_EXP_SCGY')\\n        then concat(t.expenditure_type_name,'.')\\n      when (t.bill_code like 'CLBX%' and  t.expenditure_type_code='DIM_EXP_YC_001')\\n        then concat(t.expenditure_type_name,'.')\\n      when (t.bill_code like 'CLBX%' and  t.expenditure_type_code='DIM_EXP_EAT')\\n        then '交通类-交通费.'\\n       when (t.bill_code like 'FYBX%' and  t.expenditure_type_code='DIM_EXP_ZYLHYF_001')\\n        then '渠道-伙伴合作'\\n      when (t.expenditure_type_code = 'DIM_EXP_PPT_001' and  t.expenditure_type_name like '%调研报告%' )\\n         then '品牌-调用报告'\\n      when (t.expenditure_type_code = 'DIM_EXP_ZZZ_001' and t.expenditure_type_name='杂志-资料费')\\n         then '杂志-推广费'\\n      when (t.expenditure_type_code = 'DIM_EXP_ZZC_001' and t.expenditure_type_name='杂志-出刊费')\\n         then '杂志-发行费'\\n      when (t.expenditure_type_code = 'DIM_EXP_QTSK_001' and t.expenditure_type_name='品牌文化-其他书刊')\\n         then '品牌-活动费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_SKSF_001' and t.expenditure_type_name='品牌文化-书刊书费')\\n         then '品牌-活动费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_HD_001' and t.expenditure_type_name='品牌文化-其他活动')\\n         then '品牌-活动费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_HZZF_001' and t.expenditure_type_name='品牌文化-合作政府')\\n         then '品牌-活动费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_WLYXWZYWF_001' and  t.expenditure_type_name='品牌文化-网络营销网站运维费')\\n         then '品牌-平台费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_SKKWF_001' and t.expenditure_type_name='品牌文化-书刊刊物费')\\n         then '品牌-活动费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_HZJG_001' and t.expenditure_type_name='品牌文化-合作机构')\\n         then '品牌-活动费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_XCP_001' and t.expenditure_type_name='品牌文化-宣传品')\\n         then '品牌-营销物料'\\n      when (t.expenditure_type_code = 'DIM_EXP_QTHZ_001' and t.expenditure_type_name='品牌文化-其他合作')\\n         then '品牌-活动费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_HZCS_001' and t.expenditure_type_name='品牌文化-合作厂商')\\n         then '品牌-活动费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_SKZTF_001' and t.expenditure_type_name='品牌文化-书刊专题费')\\n         then '品牌-活动费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_QC' and t.expenditure_type_name='差旅类-汽车')\\n         then '交通类-交通费'\\n      when (t.expenditure_type_code = 'DIM_EXP_DDGRDF' and t.expenditure_type_name='差旅类-滴滴个人垫付')\\n         then '交通类-交通费'\\n      when (t.expenditure_type_code = 'DIM_EXP_DCF_002' and t.expenditure_type_name='交通类-其他交通')\\n         then '交通类-交通费'\\n      when (t.expenditure_type_code = 'DIM_EXP_KHHCP_001' and t.expenditure_type_name='交通类-客户火车票')\\n         then '交通类-交通费'\\n      when (t.expenditure_type_code = 'DIM_EXP_CTQCP_001' and t.expenditure_type_name='交通类-长途汽车票')\\n         then '交通类-交通费'\\n      when (t.expenditure_type_code = 'DIM_EXP_TCJGLGQF_001' and t.expenditure_type_name='交通类-停车及过路过桥费')\\n         then '交通类-交通费'\\n      when (t.expenditure_type_code = 'DIM_EXP_QYZCF_001' and t.expenditure_type_name='交通类-企业租车费')\\n         then '交通类-交通费'\\n      when (t.expenditure_type_code = 'DIM_EXP_JYF_001' and t.expenditure_type_name='交通类-加油费')\\n         then '交通类-交通费'\\n      when (t.expenditure_type_code = 'DIM_EXP_KHJP_001' and t.expenditure_type_name like '%客户机票%')\\n         then '餐饮类-客户招待'\\n      when (t.expenditure_type_code = 'DIM_EXP_KHLC_001' and t.expenditure_type_name='客户轮船')\\n         then '餐饮类-客户招待'\\n      when (t.expenditure_type_code = 'DIM_EXP_YF_001' and t.expenditure_type_name='行政-装修')\\n         then '行政-办公室维护'\\n      when (t.expenditure_type_code = 'DIM_EXP_GSNH_001' and t.expenditure_type_name='行政-公司年会')\\n         then '公共费用-福利费'\\n      when (t.expenditure_type_code = 'DIM_EXP_TJCF_001' and t.expenditure_type_name='餐饮类-团建餐费')\\n         then '公共费用-部门（团队）建设费'\\n      when (t.expenditure_type_code = 'DIM_EXP_WF_001' and t.expenditure_type_name='网费')\\n         then '办公-办公用品'\\n      when (t.expenditure_type_code = 'DIM_EXP_SJDHF_001' and t.expenditure_type_name='手机电话费')\\n         then '办公-办公用品'\\n      when (t.expenditure_type_code = 'DIM_EXP_YJF_001' and t.expenditure_type_name='邮寄费')\\n         then '办公-办公用品'\\n      when (t.expenditure_type_code = 'DIM_EXP_DYFYZD_001' and t.expenditure_type_name='打印复印装订')\\n         then '办公-办公用品'\\n      when (t.expenditure_type_code = 'DIM_EXP_QTBGXGFY_001' and t.expenditure_type_name='办公礼品类-其他办公相关费用')\\n         then '办公-办公用品'\\n      when (t.expenditure_type_code = 'DIM_EXP_DZYH_001' and t.expenditure_type_name='办公礼品类-快递费')\\n         then '办公-办公用品'\\n      when (t.expenditure_type_code = 'DIM_EXP_LPF_001' and t.expenditure_type_name='礼品费')\\n         then '办公-礼品费'\\n      when (t.expenditure_type_code = 'DIM_EXP_SJF_001' and t.expenditure_type_name='采购-图书')\\n         then '办公-办公用品'\\n      when (t.expenditure_type_code = 'DIM_EXP_CGY_001' and t.expenditure_type_name='采购-佣金费')\\n         then '渠道-佣金费'\\n      when (t.expenditure_type_code = 'DIM_EXP_RQF_001' and t.expenditure_type_name='燃气费')\\n         then '租房相关-项目组租房相关费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_LHF_001' and t.expenditure_type_name='绿化费')\\n         then '行政-办公室维护'\\n      when (t.expenditure_type_code = 'DIM_EXP_NQF_001' and t.expenditure_type_name='租房相关-暖气费')\\n         then '租房相关-项目组租房相关费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_SDF_001' and t.expenditure_type_name='租房相关-水电费')\\n         then '租房相关-项目组租房相关费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_BAF_001' and t.expenditure_type_name='租房相关-宽带费')\\n         then '租房相关-项目组租房相关费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_WYF_001' and t.expenditure_type_name='租房相关-物业费')\\n         then '租房相关-项目组租房相关费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_BJF_001' and t.expenditure_type_name='租房相关-床上用品')\\n         then '公共费用-福利费'\\n      when (t.expenditure_type_code = 'DIM_EXP_TXF_001' and t.expenditure_type_name= '公共费用-通讯费')\\n         then '办公-办公用品'\\n      when (t.expenditure_type_code = 'DIM_EXP_JHSYFL_001' and t.expenditure_type_name='公共费用-结婚生育福利')\\n         then '公共费用-福利费'\\n      when (t.expenditure_type_code = 'DIM_EXP_LPFY_001' and t.expenditure_type_name='礼品费')\\n         then '办公-礼品费'\\n      when (t.expenditure_type_code = 'DIM_EXP_XMHDF_001' and t.expenditure_type_name='公共费用-项目活动费')\\n         then '公共费用-福利费'\\n      when (t.expenditure_type_code = 'DIM_EXP_SJF_002' and t.expenditure_type_name='财务-审计费')\\n         then '财务-鉴证咨询'\\n      when (t.expenditure_type_code = 'DIM_EXP_YZF_001' and t.expenditure_type_name='财务-验资费')\\n         then '财务-鉴证咨询'\\n      when (t.expenditure_type_code = 'DIM_EXP_CB_001' and t.expenditure_type_name='云流量-成本')\\n         then '元年云-服务器运营成本'\\n      when (t.expenditure_type_code = 'DIM_EXP_KHZS_001' and t.expenditure_type_name='住宿类-客户住宿')\\n         then '餐饮类-客户招待'\\n    else t.expenditure_type_name\\n  end \\n  ) as pay_s_level_name--支出类型二级名称\\nfrom\\n\\tdwd_fact_cost_control_detail t\\nleft join dwd_dim_cost_pay_type y on\\n\\t(t.expenditure_type_parent_id = y.OBJECT_ID)\\nwhere t.cost_secondownership_departmentid is not null or t.cost_secondownership_departmentid !=''\",\"tableInfo\":[{\"tableName\":\"dwd_dim_cost_pay_type\",\"lane\":\"27786ca8-f569-49c8-864a-f5f3b04cabd4\",\"isActive\":true},{\"tableName\":\"dwd_fact_cost_control_detail\",\"lane\":\"55331083-3122-4ccf-a7c9-c62bd9e31f2b\",\"isActive\":false}]},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"费用归属二级\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.sql.SparkSqlScriptProcessor\",\"input_point_ids\":[\"f4f26eaf-8afe-4cb6-9cbb-f4271be55751\"],\"out_point_ids\":[\"0ea45c70-723e-49c7-88dd-28ed9d179883\"],\"inputLanes\":[\"27786ca8-f569-49c8-864a-f5f3b04cabd4\",\"55331083-3122-4ccf-a7c9-c62bd9e31f2b\"],\"outputLanes\":[\"0ea45c70-723e-49c7-88dd-28ed9d179883\"]},{\"dagId\":\"11ed0bf19650e159928e7b7d5ec54760\",\"stageId\":\"2e512fb5-a48d-4a5e-b975-70dd027148aa\",\"checkPassed\":true,\"componentType\":\"PROCESS\",\"configPageCode\":\"SQL_SCRIPT\",\"configPageCodeName\":\"SQL_SCRIPT\",\"configuration\":{\"sqlScript\":\"select\\n\\tt.bill_code ,\\n  t.cost_ownership_id, --费用归属父级ID因业务改动，先只需用二级的ID去关联\\n  t.project_code, \\n  t.project_description,\\n\\tt.business_year as share_year,\\n\\t--年\\n\\tt.business_month as share_month,\\n\\t--期间\\n  t.cost_firstownership_departmentid org_id,\\n  t.cost_firstownership_departmentcode org_code,\\n  -- 上生产后可能进行修改\\n  (case \\n      when (t.cost_firstownership_departmentcode='YN001' or t.cost_firstownership_departmentname='综合中心本部')\\n        then '管理团队'\\n      when (t.cost_firstownership_departmentcode='YN026' or t.cost_firstownership_departmentname = '大客户经营二中心本部')\\n        then '大客户经营二中心' \\n      when (t.cost_firstownership_departmentcode='YN003' or t.cost_firstownership_departmentname = '品牌营销中心本部')\\n        then '品牌营销中心'   \\n      when (t.cost_firstownership_departmentcode='YN006' or t.cost_firstownership_departmentname = '研发中心本部')\\n        then '研发中心'\\n      when (t.cost_firstownership_departmentcode='YN016' or t.cost_firstownership_departmentname = '银行行业中心本部')\\n        then '银行行业中心（BK）' \\n      when (t.cost_firstownership_departmentcode='YN024' or t.cost_firstownership_departmentname = '零售快消行业中心本部')\\n        then '零售快消行业中心（RF）' \\n        when (t.cost_firstownership_departmentcode='YN034' or t.cost_firstownership_departmentname = '视觉设计部')\\n        then '视觉设计部' \\n      when (t.cost_firstownership_departmentcode='YN012' or t.cost_firstownership_departmentname = '金融行业中心本部')\\n        then '金融行业中心（FC）' \\n       when (t.cost_firstownership_departmentcode='YN022' or t.cost_firstownership_departmentname = '能源化工行业中心本部')\\n        then '能源化工行业中心（EC）' \\n      when (t.cost_firstownership_departmentcode='YN023' or t.cost_firstownership_departmentname = '装备制造行业中心本部')\\n        then '装备制造行业中心（EM）' \\n       when (t.cost_firstownership_departmentcode='YN011.001' or t.cost_firstownership_departmentname = 'RS华东事业部')\\n        then 'RS华东交付一部' \\n       when (t.cost_firstownership_departmentcode='YN011.002' or t.cost_firstownership_departmentname = 'RS华南事业部')\\n        then 'RS华南交付部' \\n        when (t.cost_firstownership_departmentcode='YN011.004' or t.cost_firstownership_departmentname = 'RS华北事业部')\\n        then 'RS华北交付一部' \\n       when (t.cost_firstownership_departmentcode='YN032.001' or t.cost_firstownership_departmentname = '财务共享产品中心')\\n        then '财务共享产品中心' \\n       when (t.cost_firstownership_departmentcode='YN027.001' or t.cost_firstownership_departmentname = '央企销售部')\\n        then '央企销售部' \\n        when (t.cost_firstownership_departmentcode='YN013' or t.cost_firstownership_departmentname = '大客户经营中心本部')\\n        then '大客户经营中心(KA)' \\n       when (t.cost_firstownership_departmentcode='YN011' or t.cost_firstownership_departmentname = '地产行业中心本部')\\n        then '地产行业中心（RS）' \\n      when (t.cost_firstownership_departmentcode='YN025' or t.cost_firstownership_departmentname = '科技服务行业中心本部')\\n        then '科技服务行业中心（TS）' \\n       when (t.cost_firstownership_departmentcode='YN038.001' or t.cost_firstownership_departmentname = 'RPA产品中心')\\n        then 'RPA产品中心' \\n      when (t.cost_firstownership_departmentcode='YN009' or t.cost_firstownership_departmentname = '解决方案中心本部')\\n        then '解决方案中心' \\n      when (t.cost_firstownership_departmentcode='YN031.001' or t.cost_firstownership_departmentname = '预算产品中心')\\n        then '预算产品中心' \\n       when (t.cost_firstownership_departmentcode='YN035.001' or t.cost_firstownership_departmentname = '采购产品中心')\\n        then '采购产品中心' \\n       when (t.cost_firstownership_departmentcode='YN035.001' or t.cost_firstownership_departmentname = '采购产品中心')\\n        then '采购产品中心' \\n       when (t.cost_firstownership_departmentcode='YN010' or t.cost_firstownership_departmentname = '政府与公共事务中心本部')\\n        then '政府与公共事务中心' \\n       when (t.cost_firstownership_departmentcode='YN041.001' or t.cost_firstownership_departmentname = '物资主数据产品中心')\\n        then '物资主数据产品中心' \\n       when (t.cost_firstownership_departmentcode='YN029' or t.cost_firstownership_departmentname = '管理咨询中心')\\n        then '管理咨询中心本部' \\n      when (t.cost_firstownership_departmentcode='YN037.001' or t.cost_firstownership_departmentname = '商旅产品中心')\\n        then '商旅产品中心' \\n       when (t.cost_firstownership_departmentcode='YN034.001' or t.cost_firstownership_departmentname = '视觉设计部')\\n        then '视觉设计部' \\n        when (t.cost_firstownership_departmentcode='YN033.001' or t.cost_firstownership_departmentname = '方舟平台产品中心')\\n        then '方舟平台产品中心' \\n       when (t.cost_firstownership_departmentcode='YN039.001' or t.cost_firstownership_departmentname = '共享创新业务销售部')\\n        then '共享创新业务销售部' \\n       when (t.cost_firstownership_departmentcode='YN036.001' or t.cost_firstownership_departmentname = '税务产品中心')\\n        then '税务产品中心' \\n       when (t.cost_firstownership_departmentcode='YN028.001' or t.cost_firstownership_departmentname = '西南区销售部')\\n        then '西南区销售部' \\n       when (t.cost_firstownership_departmentcode='YN011.005' or t.cost_firstownership_departmentname = '地产行业发展部')\\n       then '地产研究院' \\n       when (t.cost_firstownership_departmentcode='YN043' or t.cost_firstownership_departmentname = '大客户事业五部（作废）')\\n       then '大客户事业五部' \\n      else t.cost_firstownership_departmentname\\n   end)  as org_name, --费用组织一级部门名称\\n  --t.cost_firstownership_departmentid,\\n\\t--t.cost_firstownership_departmentcode as cost_firstownership_departmentcode,\\n\\t--费用归属一级部门编码\\n  --t.cost_firstownership_departmentname,\\n\\t--费用归属一级部门名称\\n  --t.cost_secondownership_departmentid,\\n\\t--t.cost_secondownership_departmentcode as cost_secondownership_departmentcode,\\n\\t--费用归属二级部门编码\\n   --t.cost_secondownership_departmentname as cost_secondownership_departmentname,\\n     case \\n       when t.cost_ownership_name = '研发费用' then '研发费用.'\\n       else t.cost_ownership_name\\n   end as cost_s_leveltype_name,--费用归属二级名称\\n   case \\n       when t.cost_ownership_code = '研发费用' then '研发费用.'\\n       else t.cost_ownership_code\\n   end as cost_s_leveltype_code, --费用归属二级编码\\n\\ty.CODE as pay_f_level_code, --支出类型一级编码\\n   (case\\n        when (t.expenditure_type_code= 'DIM_EXP_SCGYBT_001')\\n           then '私车公用'\\n        when (t.expenditure_type_code= 'DIM_EXP_SCGY' and t.bill_code like 'FYBX%')\\n           then '私车公用'   \\n        when  (t.expenditure_type_code= 'DIM_EXP_WWFWF_001')\\n           then '外包服务费'\\n         when  (t.expenditure_type_code= 'DIM_EXP_CGWBFWFDSZF_001')\\n           then '外包服务费'   \\n        else y.NAME    \\n   end) as pay_f_level_name, --支出类型一级名称\\n\\tt.expenditure_type_code as pay_s_level_code, --支出类型二级编码\\n  (case\\n      when (t.bill_code like 'CLBX%' and  t.expenditure_type_code='DIM_EXP_SCGY')\\n        then concat(t.expenditure_type_name,'.')\\n      when (t.bill_code like 'CLBX%' and  t.expenditure_type_code='DIM_EXP_YC_001')\\n        then concat(t.expenditure_type_name,'.')\\n      when (t.bill_code like 'CLBX%' and  t.expenditure_type_code='DIM_EXP_EAT')\\n        then '交通类-交通费.'\\n       when (t.bill_code like 'FYBX%' and  t.expenditure_type_code='DIM_EXP_ZYLHYF_001')\\n        then '渠道-伙伴合作'\\n      when (t.expenditure_type_code = 'DIM_EXP_PPT_001' and  t.expenditure_type_name like '%调研报告%' )\\n         then '品牌-调用报告'\\n      when (t.expenditure_type_code = 'DIM_EXP_ZZZ_001' and t.expenditure_type_name='杂志-资料费')\\n         then '杂志-推广费'\\n      when (t.expenditure_type_code = 'DIM_EXP_ZZC_001' and t.expenditure_type_name='杂志-出刊费')\\n         then '杂志-发行费'\\n      when (t.expenditure_type_code = 'DIM_EXP_QTSK_001' and t.expenditure_type_name='品牌文化-其他书刊')\\n         then '品牌-活动费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_SKSF_001' and t.expenditure_type_name='品牌文化-书刊书费')\\n         then '品牌-活动费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_HD_001' and t.expenditure_type_name='品牌文化-其他活动')\\n         then '品牌-活动费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_HZZF_001' and t.expenditure_type_name='品牌文化-合作政府')\\n         then '品牌-活动费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_WLYXWZYWF_001' and  t.expenditure_type_name='品牌文化-网络营销网站运维费')\\n         then '品牌-平台费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_SKKWF_001' and t.expenditure_type_name='品牌文化-书刊刊物费')\\n         then '品牌-活动费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_HZJG_001' and t.expenditure_type_name='品牌文化-合作机构')\\n         then '品牌-活动费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_XCP_001' and t.expenditure_type_name='品牌文化-宣传品')\\n         then '品牌-营销物料'\\n      when (t.expenditure_type_code = 'DIM_EXP_QTHZ_001' and t.expenditure_type_name='品牌文化-其他合作')\\n         then '品牌-活动费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_HZCS_001' and t.expenditure_type_name='品牌文化-合作厂商')\\n         then '品牌-活动费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_SKZTF_001' and t.expenditure_type_name='品牌文化-书刊专题费')\\n         then '品牌-活动费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_QC' and t.expenditure_type_name='差旅类-汽车')\\n         then '交通类-交通费'\\n      when (t.expenditure_type_code = 'DIM_EXP_DDGRDF' and t.expenditure_type_name='差旅类-滴滴个人垫付')\\n         then '交通类-交通费'\\n      when (t.expenditure_type_code = 'DIM_EXP_DCF_002' and t.expenditure_type_name='交通类-其他交通')\\n         then '交通类-交通费'\\n      when (t.expenditure_type_code = 'DIM_EXP_KHHCP_001' and t.expenditure_type_name='交通类-客户火车票')\\n         then '交通类-交通费'\\n      when (t.expenditure_type_code = 'DIM_EXP_CTQCP_001' and t.expenditure_type_name='交通类-长途汽车票')\\n         then '交通类-交通费'\\n      when (t.expenditure_type_code = 'DIM_EXP_TCJGLGQF_001' and t.expenditure_type_name='交通类-停车及过路过桥费')\\n         then '交通类-交通费'\\n      when (t.expenditure_type_code = 'DIM_EXP_QYZCF_001' and t.expenditure_type_name='交通类-企业租车费')\\n         then '交通类-交通费'\\n      when (t.expenditure_type_code = 'DIM_EXP_JYF_001' and t.expenditure_type_name='交通类-加油费')\\n         then '交通类-交通费'\\n      when (t.expenditure_type_code = 'DIM_EXP_KHJP_001' and t.expenditure_type_name like '%客户机票%')\\n         then '餐饮类-客户招待'\\n      when (t.expenditure_type_code = 'DIM_EXP_KHLC_001' and t.expenditure_type_name='客户轮船')\\n         then '餐饮类-客户招待'\\n      when (t.expenditure_type_code = 'DIM_EXP_YF_001' and t.expenditure_type_name='行政-装修')\\n         then '行政-办公室维护'\\n      when (t.expenditure_type_code = 'DIM_EXP_GSNH_001' and t.expenditure_type_name='行政-公司年会')\\n         then '公共费用-福利费'\\n      when (t.expenditure_type_code = 'DIM_EXP_TJCF_001' and t.expenditure_type_name='餐饮类-团建餐费')\\n         then '公共费用-部门（团队）建设费'\\n      when (t.expenditure_type_code = 'DIM_EXP_WF_001' and t.expenditure_type_name='网费')\\n         then '办公-办公用品'\\n      when (t.expenditure_type_code = 'DIM_EXP_SJDHF_001' and t.expenditure_type_name='手机电话费')\\n         then '办公-办公用品'\\n      when (t.expenditure_type_code = 'DIM_EXP_YJF_001' and t.expenditure_type_name='邮寄费')\\n         then '办公-办公用品'\\n      when (t.expenditure_type_code = 'DIM_EXP_DYFYZD_001' and t.expenditure_type_name='打印复印装订')\\n         then '办公-办公用品'\\n      when (t.expenditure_type_code = 'DIM_EXP_QTBGXGFY_001' and t.expenditure_type_name='办公礼品类-其他办公相关费用')\\n         then '办公-办公用品'\\n      when (t.expenditure_type_code = 'DIM_EXP_DZYH_001' and t.expenditure_type_name='办公礼品类-快递费')\\n         then '办公-办公用品'\\n      when (t.expenditure_type_code = 'DIM_EXP_LPF_001' and t.expenditure_type_name='礼品费')\\n         then '办公-礼品费'\\n      when (t.expenditure_type_code = 'DIM_EXP_SJF_001' and t.expenditure_type_name='采购-图书')\\n         then '办公-办公用品'\\n      when (t.expenditure_type_code = 'DIM_EXP_CGY_001' and t.expenditure_type_name='采购-佣金费')\\n         then '渠道-佣金费'\\n      when (t.expenditure_type_code = 'DIM_EXP_RQF_001' and t.expenditure_type_name='燃气费')\\n         then '租房相关-项目组租房相关费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_LHF_001' and t.expenditure_type_name='绿化费')\\n         then '行政-办公室维护'\\n      when (t.expenditure_type_code = 'DIM_EXP_NQF_001' and t.expenditure_type_name='租房相关-暖气费')\\n         then '租房相关-项目组租房相关费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_SDF_001' and t.expenditure_type_name='租房相关-水电费')\\n         then '租房相关-项目组租房相关费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_BAF_001' and t.expenditure_type_name='租房相关-宽带费')\\n         then '租房相关-项目组租房相关费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_WYF_001' and t.expenditure_type_name='租房相关-物业费')\\n         then '租房相关-项目组租房相关费用'\\n      when (t.expenditure_type_code = 'DIM_EXP_BJF_001' and t.expenditure_type_name='租房相关-床上用品')\\n         then '公共费用-福利费'\\n      when (t.expenditure_type_code = 'DIM_EXP_TXF_001' and t.expenditure_type_name= '公共费用-通讯费')\\n         then '办公-办公用品'\\n      when (t.expenditure_type_code = 'DIM_EXP_JHSYFL_001' and t.expenditure_type_name='公共费用-结婚生育福利')\\n         then '公共费用-福利费'\\n      when (t.expenditure_type_code = 'DIM_EXP_LPFY_001' and t.expenditure_type_name='礼品费')\\n         then '办公-礼品费'\\n      when (t.expenditure_type_code = 'DIM_EXP_XMHDF_001' and t.expenditure_type_name='公共费用-项目活动费')\\n         then '公共费用-福利费'\\n      when (t.expenditure_type_code = 'DIM_EXP_SJF_002' and t.expenditure_type_name='财务-审计费')\\n         then '财务-鉴证咨询'\\n      when (t.expenditure_type_code = 'DIM_EXP_YZF_001' and t.expenditure_type_name='财务-验资费')\\n         then '财务-鉴证咨询'\\n      when (t.expenditure_type_code = 'DIM_EXP_CB_001' and t.expenditure_type_name='云流量-成本')\\n         then '元年云-服务器运营成本'\\n      when (t.expenditure_type_code = 'DIM_EXP_KHZS_001' and t.expenditure_type_name='住宿类-客户住宿')\\n         then '餐饮类-客户招待'\\n    else t.expenditure_type_name\\n  end \\n  ) as pay_s_level_name--支出类型二级名称\\nfrom\\n\\tdwd_fact_cost_control_detail t\\nleft join dwd_dim_cost_pay_type y on\\n\\t(t.expenditure_type_parent_id = y.OBJECT_ID)\\nwhere t.cost_firstownership_departmentid is not null or t.cost_firstownership_departmentid !=''\",\"tableInfo\":[{\"tableName\":\"dwd_dim_cost_pay_type\",\"lane\":\"27786ca8-f569-49c8-864a-f5f3b04cabd4\",\"isActive\":true},{\"tableName\":\"dwd_fact_cost_control_detail\",\"lane\":\"55331083-3122-4ccf-a7c9-c62bd9e31f2b\",\"isActive\":false}]},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"费用归属一级\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.sql.SparkSqlScriptProcessor\",\"input_point_ids\":[\"4b66299f-8882-4b1f-9050-d96fdf78096d\"],\"out_point_ids\":[\"076c5140-d61b-42d9-a701-127e15f76d59\"],\"inputLanes\":[\"27786ca8-f569-49c8-864a-f5f3b04cabd4\",\"55331083-3122-4ccf-a7c9-c62bd9e31f2b\"],\"outputLanes\":[\"076c5140-d61b-42d9-a701-127e15f76d59\"]},{\"dagId\":\"11ed0bf19650e159928e7b7d5ec54760\",\"stageId\":\"950c8924-5551-40a4-86b3-bf9197b27fb8\",\"checkPassed\":true,\"componentType\":\"PROCESS\",\"configPageCode\":\"SQL_SCRIPT\",\"configPageCodeName\":\"SQL_SCRIPT\",\"configuration\":{\"sqlScript\":\"(\\n  select * \\n  from table1 t1\\n  where t1.org_code not in('YN005.011','YN006.006.010','YN006.014','YN101.29')\\n   and t1.project_code not in('O2019114280','O2019104234','O2018121344','O2018120502','O2019032564','O2018120487','O2019104259',\\n                             'MK20220009','MK20210001')\\n)\\nunion all\\n(\\n  select *\\n  from table2 t2\\n  where t2.org_code not in('YN005.011','YN006.006.010','YN006.014','YN101.29')  \\n   and t2.project_code not in('O2019114280','O2019104234','O2018121344','O2018120502','O2019032564','O2018120487','O2019104259',\\n                             'MK20220009','MK20210001')\\n)\\n                  \",\"tableInfo\":[{\"tableName\":\"table1\",\"lane\":\"0ea45c70-723e-49c7-88dd-28ed9d179883\",\"isActive\":true},{\"tableName\":\"table2\",\"lane\":\"076c5140-d61b-42d9-a701-127e15f76d59\",\"isActive\":false}]},\"maxInputPoint\":1,\"maxOutputPoint\":1,\"name\":\"费用归属合并\",\"stageLibrary\":\"com.yuanian.dmp.transformer.plugins.sql.SparkSqlScriptProcessor\",\"input_point_ids\":[\"62435bf7-d60c-4fc3-9f01-529060524fc2\"],\"out_point_ids\":[\"bbca9d22-5f11-4ba9-916f-91fbb9b2a98f\"],\"inputLanes\":[\"0ea45c70-723e-49c7-88dd-28ed9d179883\",\"076c5140-d61b-42d9-a701-127e15f76d59\"],\"outputLanes\":[\"bbca9d22-5f11-4ba9-916f-91fbb9b2a98f\"]}],\"parameters\":{},\"sparkConfig\":{\"spark.master\":\"yarn\",\"sparkConfig\":{\"spark.executor.memory\":\"4g\",\"spark.driver.memory\":\"2g\"}},\"objectId\":\"11ed0bf19650e159928e7b7d5ec54760\"}",
            "tenantId": "system",
            "objectId": "11ed0bf19650e159928e7b7d5ec54760",
            "createDate": "2022-07-25 16:12:55"
        }
    ],
    "_datasets": {
        "extensionClass": "com.yuanian.dmp.releasecenter.migration.SparkJobInfoMigration",
        "updateDate": "2021-11-25 10:40:22",
        "pOrgId": null,
        "updateLogin": "ECS_SEED_DATA",
        "appDisplayName": "数据中台",
        "appName": "86299de60dc311eba68c912798543ca5",
        "description": "可视化数据流迁移",
        "nameField": null,
        "pAppId": null,
        "title": "可视化数据流迁移",
        "versionNumber": 10,
        "pDeleted": "FALSE",
        "metadataId": "441d2abdd40a460cab72b22b6539d98b",
        "createBy": "11ec21a17c3b87a88fc0bdc6f7109cc0",
        "isDeleted": "N",
        "updateBy": "11ec21a17c3b87a88fc0bdc6f7109cc0",
        "name": "可视化数据流迁移",
        "tenantId": "system",
        "objectId": "11ec324be297aeac8fc029be5c1d8183",
        "status": "A",
        "createDate": "2021-11-25 10:14:14"
    }
}